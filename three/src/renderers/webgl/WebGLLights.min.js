/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/src/renderers/webgl/WebGLLights.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Color}from"../../math/Color.js";import{Matrix4}from"../../math/Matrix4.js";import{Vector2}from"../../math/Vector2.js";import{Vector3}from"../../math/Vector3.js";function UniformsCache(){var o={};return{get:function(t){if(void 0!==o[t.id])return o[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new Vector3,color:new Color};break;case"SpotLight":i={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":i={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":i={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return o[t.id]=i,i}}}function ShadowUniformsCache(){var o={};return{get:function(t){if(void 0!==o[t.id])return o[t.id];var i;switch(t.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3}}return o[t.id]=i,i}}}var nextVersion=0;function shadowCastingLightsFirst(o,t){return(t.castShadow?1:0)-(o.castShadow?1:0)}function WebGLLights(){for(var o=new UniformsCache,t=ShadowUniformsCache(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)i.probe.push(new Vector3);var e=new Vector3,r=new Matrix4,n=new Matrix4;return{setup:function(a,s,h){for(var d=0,c=0,l=0,p=0;p<9;p++)i.probe[p].set(0,0,0);var w=0,m=0,g=0,S=0,u=0,x=0,f=0,M=0,L=h.matrixWorldInverse;a.sort(shadowCastingLightsFirst),p=0;for(var y=a.length;p<y;p++){var C=a[p],b=C.color,v=C.intensity,V=C.distance,P=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)d+=b.r*v,c+=b.g*v,l+=b.b*v;else if(C.isLightProbe)for(var W=0;W<9;W++)i.probe[W].addScaledVector(C.sh.coefficients[W],v);else if(C.isDirectionalLight){if((A=o.get(C)).color.copy(C.color).multiplyScalar(C.intensity),A.direction.setFromMatrixPosition(C.matrixWorld),e.setFromMatrixPosition(C.target.matrixWorld),A.direction.sub(e),A.direction.transformDirection(L),C.castShadow){var F=C.shadow;(z=t.get(C)).shadowBias=F.bias,z.shadowRadius=F.radius,z.shadowMapSize=F.mapSize,i.directionalShadow[w]=z,i.directionalShadowMap[w]=P,i.directionalShadowMatrix[w]=C.shadow.matrix,x++}i.directional[w]=A,w++}else if(C.isSpotLight)(A=o.get(C)).position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(L),A.color.copy(b).multiplyScalar(v),A.distance=V,A.direction.setFromMatrixPosition(C.matrixWorld),e.setFromMatrixPosition(C.target.matrixWorld),A.direction.sub(e),A.direction.transformDirection(L),A.coneCos=Math.cos(C.angle),A.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),A.decay=C.decay,C.castShadow&&(F=C.shadow,(z=t.get(C)).shadowBias=F.bias,z.shadowRadius=F.radius,z.shadowMapSize=F.mapSize,i.spotShadow[g]=z,i.spotShadowMap[g]=P,i.spotShadowMatrix[g]=C.shadow.matrix,M++),i.spot[g]=A,g++;else if(C.isRectAreaLight)(A=o.get(C)).color.copy(b).multiplyScalar(v),A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(L),n.identity(),r.copy(C.matrixWorld),r.premultiply(L),n.extractRotation(r),A.halfWidth.set(.5*C.width,0,0),A.halfHeight.set(0,.5*C.height,0),A.halfWidth.applyMatrix4(n),A.halfHeight.applyMatrix4(n),i.rectArea[S]=A,S++;else if(C.isPointLight){var z;if((A=o.get(C)).position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(L),A.color.copy(C.color).multiplyScalar(C.intensity),A.distance=C.distance,A.decay=C.decay,C.castShadow)F=C.shadow,(z=t.get(C)).shadowBias=F.bias,z.shadowRadius=F.radius,z.shadowMapSize=F.mapSize,z.shadowCameraNear=F.camera.near,z.shadowCameraFar=F.camera.far,i.pointShadow[m]=z,i.pointShadowMap[m]=P,i.pointShadowMatrix[m]=C.shadow.matrix,f++;i.point[m]=A,m++}else if(C.isHemisphereLight){var A;(A=o.get(C)).direction.setFromMatrixPosition(C.matrixWorld),A.direction.transformDirection(L),A.direction.normalize(),A.skyColor.copy(C.color).multiplyScalar(v),A.groundColor.copy(C.groundColor).multiplyScalar(v),i.hemi[u]=A,u++}}i.ambient[0]=d,i.ambient[1]=c,i.ambient[2]=l;var D=i.hash;D.directionalLength===w&&D.pointLength===m&&D.spotLength===g&&D.rectAreaLength===S&&D.hemiLength===u&&D.numDirectionalShadows===x&&D.numPointShadows===f&&D.numSpotShadows===M||(i.directional.length=w,i.spot.length=g,i.rectArea.length=S,i.point.length=m,i.hemi.length=u,i.directionalShadow.length=x,i.directionalShadowMap.length=x,i.pointShadow.length=f,i.pointShadowMap.length=f,i.spotShadow.length=M,i.spotShadowMap.length=M,i.directionalShadowMatrix.length=x,i.pointShadowMatrix.length=f,i.spotShadowMatrix.length=M,D.directionalLength=w,D.pointLength=m,D.spotLength=g,D.rectAreaLength=S,D.hemiLength=u,D.numDirectionalShadows=x,D.numPointShadows=f,D.numSpotShadows=M,i.version=nextVersion++)},state:i}}export{WebGLLights};
//# sourceMappingURL=/sm/85e562c48e50e85f072dc70629884e52d40a4a59ad040d2b27b030da95f6e7a0.map