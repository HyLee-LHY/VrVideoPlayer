/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/curves/NURBSUtils.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Vector3,Vector4}from"../../../build/three.module.js";var NURBSUtils={findSpan:function(r,a,i){var c=i.length-r-1;if(a>=i[c])return c-1;if(a<=i[r])return r;for(var n=r,o=c,t=Math.floor((n+o)/2);a<i[t]||a>=i[t+1];)a<i[t]?o=t:n=t,t=Math.floor((n+o)/2);return t},calcBasisFunctions:function(r,a,i,c){var n=[],o=[],t=[];n[0]=1;for(var e=1;e<=i;++e){o[e]=a-c[r+1-e],t[e]=c[r+e]-a;for(var l=0,v=0;v<e;++v){var f=t[v+1],s=o[e-v],u=n[v]/(f+s);n[v]=l+f*u,l=s*u}n[e]=l}return n},calcBSplinePoint:function(r,a,i,c){for(var n=this.findSpan(r,c,a),o=this.calcBasisFunctions(n,c,r,a),t=new Vector4(0,0,0,0),e=0;e<=r;++e){var l=i[n-r+e],v=o[e],f=l.w*v;t.x+=l.x*f,t.y+=l.y*f,t.z+=l.z*f,t.w+=l.w*v}return t},calcBasisFunctionDerivatives:function(r,a,i,c,n){for(var o=[],t=0;t<=i;++t)o[t]=0;var e=[];for(t=0;t<=c;++t)e[t]=o.slice(0);var l=[];for(t=0;t<=i;++t)l[t]=o.slice(0);l[0][0]=1;for(var v=o.slice(0),f=o.slice(0),s=1;s<=i;++s){v[s]=a-n[r+1-s],f[s]=n[r+s]-a;for(var u=0,S=0;S<s;++S){var d=f[S+1],h=v[s-S];l[s][S]=d+h;var p=l[S][s-1]/l[s][S];l[S][s]=u+d*p,u=h*p}l[s][s]=u}for(s=0;s<=i;++s)e[0][s]=l[s][i];for(S=0;S<=i;++S){var w=0,B=1,y=[];for(t=0;t<=i;++t)y[t]=o.slice(0);y[0][0]=1;for(var m=1;m<=c;++m){var x=0,D=S-m,V=i-m;S>=m&&(y[B][0]=y[w][0]/l[V+1][D],x=y[B][0]*l[D][V]);var z=S-1<=V?m-1:i-S;for(s=D>=-1?1:-D;s<=z;++s)y[B][s]=(y[w][s]-y[w][s-1])/l[V+1][D+s],x+=y[B][s]*l[D+s][V];S<=V&&(y[B][m]=-y[w][m-1]/l[V+1][S],x+=y[B][m]*l[S][V]),e[m][S]=x;s=w;w=B,B=s}}for(S=i,m=1;m<=c;++m){for(s=0;s<=i;++s)e[m][s]*=S;S*=i-m}return e},calcBSplineDerivatives:function(r,a,i,c,n){for(var o=n<r?n:r,t=[],e=this.findSpan(r,c,a),l=this.calcBasisFunctionDerivatives(e,c,r,o,a),v=[],f=0;f<i.length;++f){var s=(S=i[f].clone()).w;S.x*=s,S.y*=s,S.z*=s,v[f]=S}for(var u=0;u<=o;++u){for(var S=v[e-r].clone().multiplyScalar(l[u][0]),d=1;d<=r;++d)S.add(v[e-r+d].clone().multiplyScalar(l[u][d]));t[u]=S}for(u=o+1;u<=n+1;++u)t[u]=new Vector4(0,0,0);return t},calcKoverI:function(r,a){for(var i=1,c=2;c<=r;++c)i*=c;var n=1;for(c=2;c<=a;++c)n*=c;for(c=2;c<=r-a;++c)n*=c;return i/n},calcRationalCurveDerivatives:function(r){for(var a=r.length,i=[],c=[],n=0;n<a;++n){var o=r[n];i[n]=new Vector3(o.x,o.y,o.z),c[n]=o.w}for(var t=[],e=0;e<a;++e){var l=i[e].clone();for(n=1;n<=e;++n)l.sub(t[e-n].clone().multiplyScalar(this.calcKoverI(e,n)*c[n]));t[e]=l.divideScalar(c[0])}return t},calcNURBSDerivatives:function(r,a,i,c,n){var o=this.calcBSplineDerivatives(r,a,i,c,n);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(r,a,i,c,n,o,t,e){for(var l=this.findSpan(r,o,i),v=this.findSpan(a,t,c),f=this.calcBasisFunctions(l,o,r,i),s=this.calcBasisFunctions(v,t,a,c),u=[],S=0;S<=a;++S){u[S]=new Vector4(0,0,0,0);for(var d=0;d<=r;++d){var h=n[l-r+d][v-a+S].clone(),p=h.w;h.x*=p,h.y*=p,h.z*=p,u[S].add(h.multiplyScalar(f[d]))}}var w=new Vector4(0,0,0,0);for(S=0;S<=a;++S)w.add(u[S].multiplyScalar(s[S]));w.divideScalar(w.w),e.set(w.x,w.y,w.z)}};export{NURBSUtils};
//# sourceMappingURL=/sm/2e0b46002c8bba16d6f2ccd010b91003cdbdb0bfdcb9baa8fbb5fee804a83d1a.map