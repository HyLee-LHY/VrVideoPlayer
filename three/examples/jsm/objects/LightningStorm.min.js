/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/objects/LightningStorm.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{MathUtils,Mesh,MeshBasicMaterial,Object3D}from"../../../build/three.module.js";import{LightningStrike}from"../geometries/LightningStrike.js";var LightningStorm=function(i){Object3D.call(this),i=i||{},this.stormParams=i,i.size=void 0!==i.size?i.size:1e3,i.minHeight=void 0!==i.minHeight?i.minHeight:80,i.maxHeight=void 0!==i.maxHeight?i.maxHeight:100,i.maxSlope=void 0!==i.maxSlope?i.maxSlope:1.1,i.maxLightnings=void 0!==i.maxLightnings?i.maxLightnings:3,i.lightningMinPeriod=void 0!==i.lightningMinPeriod?i.lightningMinPeriod:3,i.lightningMaxPeriod=void 0!==i.lightningMaxPeriod?i.lightningMaxPeriod:7,i.lightningMinDuration=void 0!==i.lightningMinDuration?i.lightningMinDuration:1,i.lightningMaxDuration=void 0!==i.lightningMaxDuration?i.lightningMaxDuration:2.5,this.lightningParameters=LightningStrike.copyParameters(i.lightningParameters,i.lightningParameters),this.lightningParameters.isEternal=!1,this.lightningMaterial=void 0!==i.lightningMaterial?i.lightningMaterial:new MeshBasicMaterial({color:11599871}),void 0!==i.onRayPosition?this.onRayPosition=i.onRayPosition:this.onRayPosition=function(t,n){n.set((Math.random()-.5)*i.size,0,(Math.random()-.5)*i.size);var s=MathUtils.lerp(i.minHeight,i.maxHeight,Math.random());t.set(i.maxSlope*(2*Math.random()-1),1,i.maxSlope*(2*Math.random()-1)).multiplyScalar(s).add(n)},this.onLightningDown=i.onLightningDown,this.inited=!1,this.nextLightningTime=0,this.lightningsMeshes=[],this.deadLightningsMeshes=[];for(var t=0;t<this.stormParams.maxLightnings;t++){var n=new LightningStrike(LightningStrike.copyParameters({},this.lightningParameters)),s=new Mesh(n,this.lightningMaterial);this.deadLightningsMeshes.push(s)}};LightningStorm.prototype=Object.create(Object3D.prototype),LightningStorm.prototype.constructor=LightningStorm,LightningStorm.prototype.isLightningStorm=!0,LightningStorm.prototype.update=function(i){if(this.inited||(this.nextLightningTime=this.getNextLightningTime(i)*Math.random(),this.inited=!0),i>=this.nextLightningTime){var t=this.deadLightningsMeshes.pop();if(t){var n=LightningStrike.copyParameters(t.geometry.rayParameters,this.lightningParameters);n.birthTime=i,n.deathTime=i+MathUtils.lerp(this.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration,Math.random()),this.onRayPosition(n.sourceOffset,n.destOffset),n.noiseSeed=Math.random(),this.add(t),this.lightningsMeshes.push(t)}this.nextLightningTime=this.getNextLightningTime(i)}for(var s=0,a=this.lightningsMeshes.length;s<a;){var g=this.lightningsMeshes[s],e=g.geometry,h=e.state;e.update(i),h===LightningStrike.RAY_PROPAGATING&&e.state>h&&this.onLightningDown&&this.onLightningDown(e),e.state===LightningStrike.RAY_EXTINGUISHED?(this.lightningsMeshes.splice(this.lightningsMeshes.indexOf(g),1),this.deadLightningsMeshes.push(g),this.remove(g),a--):s++}},LightningStorm.prototype.getNextLightningTime=function(i){return i+MathUtils.lerp(this.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod,Math.random())/(this.stormParams.maxLightnings+1)},LightningStorm.prototype.copy=function(i){return Object3D.prototype.copy.call(this,i),this.stormParams.size=i.stormParams.size,this.stormParams.minHeight=i.stormParams.minHeight,this.stormParams.maxHeight=i.stormParams.maxHeight,this.stormParams.maxSlope=i.stormParams.maxSlope,this.stormParams.maxLightnings=i.stormParams.maxLightnings,this.stormParams.lightningMinPeriod=i.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod=i.stormParams.lightningMaxPeriod,this.stormParams.lightningMinDuration=i.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration=i.stormParams.lightningMaxDuration,this.lightningParameters=LightningStrike.copyParameters({},i.lightningParameters),this.lightningMaterial=i.stormParams.lightningMaterial,this.onLightningDown=i.onLightningDown,this},LightningStrike.prototype.clone=function(){return new this.constructor(this.stormParams).copy(this)};export{LightningStorm};
//# sourceMappingURL=/sm/578f905e099cdb0cd6266c4acebb5c178890d4e89ff6569433e3f32adafc5ea9.map