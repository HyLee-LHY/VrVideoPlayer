/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/animation/TimelinerController.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{AnimationClip,AnimationMixer,AnimationUtils,PropertyBinding}from"../../../build/three.module.js";var TimelinerController=function(t,i,e){this._scene=t,this._trackInfo=i,this._onUpdate=e,this._mixer=new AnimationMixer(t),this._clip=null,this._action=null,this._tracks={},this._propRefs={},this._channelNames=[]};TimelinerController.prototype={constructor:TimelinerController,init:function(){for(var t=[],i=this._trackInfo,e=0,r=i.length;e!==r;++e){var n=i[e];t.push(this._addTrack(n.type,n.propertyPath,n.initialValue,n.interpolation))}this._clip=new AnimationClip("editclip",0,t),this._action=this._mixer.clipAction(this._clip).play()},setDisplayTime:function(t){this._action.time=t,this._mixer.update(0),this._onUpdate()},setDuration:function(t){this._clip.duration=t},getChannelNames:function(){return this._channelNames},getChannelKeyTimes:function(t){return this._tracks[t].times},setKeyframe:function(t,i){var e=this._tracks[t],r=e.times,n=Timeliner.binarySearch(r,i),s=e.values,a=e.getValueSize(),l=n*a;if(n<0){l=(n=~n)*a;for(var o=r.length+1,h=s.length+a,c=o-1;c!==n;--c)r[c]=r[c-1];c=h-1;for(var m=l+a-1;c!==m;--c)s[c]=s[c-a]}r[n]=i,this._propRefs[t].getValue(s,l)},delKeyframe:function(t,i){var e=this._tracks[t],r=e.times,n=Timeliner.binarySearch(r,i);if(r.length>1&&n>=0){for(var s=r.length-1,a=e.values,l=e.getValueSize(),o=a.length-l,h=n;h!==s;++h)r[h]=r[h+1];r.pop();for(var c=n*l;c!==o;++c)a[c]=a[c+l];a.length=o}},moveKeyframe:function(t,i,e,r){var n=this._tracks[t],s=n.times,a=Timeliner.binarySearch(s,i);if(a>=0){for(var l=r?s.length:a+1,o=s[a-1]<=i||!r&&i>=s[a+1];a!==l;)s[a++]+=e;o&&this._sort(n)}},serialize:function(){for(var t={duration:this._clip.duration,channels:{}},i=this._channelNames,e=this._tracks,r=t.channels,n=0,s=i.length;n!==s;++n){var a=i[n],l=e[a];r[a]={times:l.times,values:l.values}}return t},deserialize:function(t){var i=this._channelNames,e=this._tracks,r=t.channels;this.setDuration(t.duration);for(var n=0,s=i.length;n!==s;++n){var a=i[n],l=e[a],o=r[a];this._setArray(l.times,o.times),this._setArray(l.values,o.values)}this.setDisplayTime(this._mixer.time)},_sort:function(t){var i=t.times,e=AnimationUtils.getKeyframeOrder(i);this._setArray(i,AnimationUtils.sortedArray(i,1,e));var r=t.values,n=t.getValueSize();this._setArray(r,AnimationUtils.sortedArray(r,n,e))},_setArray:function(t,i){t.length=0,t.push.apply(t,i)},_addTrack:function(t,i,e,r){var n=new t(i,[0],e,r);return n.times=Array.prototype.slice.call(n.times),n.values=Array.prototype.slice.call(n.values),this._channelNames.push(i),this._tracks[i]=n,this._propRefs[i]=new PropertyBinding(this._scene,i),n}};export{TimelinerController};
//# sourceMappingURL=/sm/40ecd91ba0bb719be7537d292eafe8df02fefaa5e2defec36518fa8f260713b0.map