/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/physics/CannonPhysics.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function compose(e,n,t,a){var o=n.x,r=n.y,s=n.z,i=n.w,c=o+o,p=r+r,N=s+s,h=o*c,u=o*p,d=o*N,v=r*p,y=r*N,f=s*N,w=i*c,C=i*p,M=i*N;t[a+0]=1-(v+f),t[a+1]=u+M,t[a+2]=d-C,t[a+3]=0,t[a+4]=u-M,t[a+5]=1-(h+f),t[a+6]=y+w,t[a+7]=0,t[a+8]=d+C,t[a+9]=y-w,t[a+10]=1-(h+v),t[a+11]=0,t[a+12]=e.x,t[a+13]=e.y,t[a+14]=e.z,t[a+15]=1}function CannonPhysics(){var e=60,n=1/e,t=new CANNON.World;t.gravity.set(0,-9.8,0),t.broadphase=new CANNON.SAPBroadphase(t);var a=[],o=new WeakMap;var r=0;return setInterval(function(){var s=performance.now();if(r>0){var i=(s-r)/1e3;t.step(n,i,e)}r=s;for(var c=0,p=a.length;c<p;c++){var N=a[c];if(N.isInstancedMesh){for(var h=N.instanceMatrix.array,u=o.get(N),d=0;d<u.length;d++)compose((v=u[d]).position,v.quaternion,h,16*d);N.instanceMatrix.needsUpdate=!0}else if(N.isMesh){var v=o.get(N);N.position.copy(v.position),N.quaternion.copy(v.quaternion)}}},1e3/e),{addMesh:function(e,n=0){var r=function(e){var n=e.parameters;switch(e.type){case"BoxBufferGeometry":var t=new CANNON.Vec3;return t.x=void 0!==n.width?n.width/2:.5,t.y=void 0!==n.height?n.height/2:.5,t.z=void 0!==n.depth?n.depth/2:.5,new CANNON.Box(t);case"PlaneBufferGeometry":return new CANNON.Plane;case"SphereBufferGeometry":var a=n.radius;return new CANNON.Sphere(a)}return null}(e.geometry);null!==r&&(e.isInstancedMesh?function(e,n,r){for(var s=e.instanceMatrix.array,i=[],c=0;c<e.count;c++){var p=16*c,N=new CANNON.Vec3;N.set(s[p+12],s[p+13],s[p+14]);var h=new CANNON.Body({position:N,mass:n,shape:r});t.addBody(h),i.push(h)}n>0&&(e.instanceMatrix.setUsage(35048),a.push(e),o.set(e,i))}(e,n,r):e.isMesh&&function(e,n,r){var s=new CANNON.Vec3;s.copy(e.position);var i=new CANNON.Quaternion;i.copy(e.quaternion);var c=new CANNON.Body({position:s,quaternion:i,mass:n,shape:r});t.addBody(c),n>0&&(a.push(e),o.set(e,c))}(e,n,r))},setMeshPosition:function(e,n,t=0){e.isInstancedMesh?o.get(e)[t].position.copy(n):e.isMesh&&o.get(e).position.copy(n)}}}export{CannonPhysics};
//# sourceMappingURL=/sm/725f328f85d6e6e03de1cc996c928551a9401983697bae31815a72bf67b35a68.map