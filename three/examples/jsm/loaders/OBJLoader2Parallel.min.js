/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/loaders/OBJLoader2Parallel.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Object3D}from"../../../build/three.module.js";import{CodeBuilderInstructions,WorkerExecutionSupport}from"./obj2/worker/main/WorkerExecutionSupport.js";import{CodeSerializer}from"./obj2/utils/CodeSerializer.js";import{OBJLoader2}from"./OBJLoader2.js";import{OBJLoader2Parser}from"./obj2/OBJLoader2Parser.js";import{WorkerRunner,DefaultWorkerPayloadHandler,ObjectManipulator}from"./obj2/worker/parallel/WorkerRunner.js";const OBJLoader2Parallel=function(e){OBJLoader2.call(this,e),this.preferJsmWorker=!1,this.jsmWorkerUrl=null,this.executeParallel=!0,this.workerExecutionSupport=new WorkerExecutionSupport};OBJLoader2Parallel.OBJLOADER2_PARALLEL_VERSION="3.2.0",console.info("Using OBJLoader2Parallel version: "+OBJLoader2Parallel.OBJLOADER2_PARALLEL_VERSION),OBJLoader2Parallel.DEFAULT_JSM_WORKER_PATH="./jsm/loaders/obj2/worker/parallel/OBJLoader2JsmWorker.js",OBJLoader2Parallel.prototype=Object.assign(Object.create(OBJLoader2.prototype),{constructor:OBJLoader2Parallel,setExecuteParallel:function(e){return this.executeParallel=!0===e,this},setJsmWorker:function(e,r){if(this.preferJsmWorker=!0===e,null==r)throw"The url to the jsm worker is not valid. Aborting...";return this.jsmWorkerUrl=r,this},getWorkerExecutionSupport:function(){return this.workerExecutionSupport},buildWorkerCode:function(){let e=new CodeBuilderInstructions(!0,!0,this.preferJsmWorker);if(e.isSupportsJsmWorker()&&e.setJsmWorkerUrl(this.jsmWorkerUrl),e.isSupportsStandardWorker()){let r=new ObjectManipulator,o=new DefaultWorkerPayloadHandler(this.parser),a=new WorkerRunner({});e.addCodeFragment(CodeSerializer.serializeClass(OBJLoader2Parser,this.parser)),e.addCodeFragment(CodeSerializer.serializeClass(ObjectManipulator,r)),e.addCodeFragment(CodeSerializer.serializeClass(DefaultWorkerPayloadHandler,o)),e.addCodeFragment(CodeSerializer.serializeClass(WorkerRunner,a));let t="new "+a.constructor.name+"( new "+o.constructor.name+"( new "+this.parser.constructor.name+"() ) );";e.addStartCode(t)}return e},load:function(e,r,o,a,t){let l=this;OBJLoader2.prototype.load.call(this,e,function(e,o){"OBJLoader2ParallelDummy"===e.name?l.parser.logging.enabled&&l.parser.logging.debug&&console.debug("Received dummy answer from OBJLoader2Parallel#parse"):r(e,o)},o,a,t)},parse:function(e){if(this.executeParallel){if(this.parser.callbacks.onLoad===this.parser._onLoad)throw"No callback other than the default callback was provided! Aborting!";if(!this.workerExecutionSupport.isWorkerLoaded(this.preferJsmWorker)){this.workerExecutionSupport.buildWorker(this.buildWorkerCode());let e=this,r=function(r){e._onAssetAvailable(r)};this.workerExecutionSupport.updateCallbacks(r,function(r){e.parser.callbacks.onLoad(e.baseObject3d,r)})}this.materialHandler.createDefaultMaterials(!1),this.workerExecutionSupport.executeParallel({params:{modelName:this.modelName,instanceNo:this.instanceNo,useIndices:this.parser.useIndices,disregardNormals:this.parser.disregardNormals,materialPerSmoothingGroup:this.parser.materialPerSmoothingGroup,useOAsMesh:this.parser.useOAsMesh,materials:this.materialHandler.getMaterialsJSON()},data:{input:e,options:null},logging:{enabled:this.parser.logging.enabled,debug:this.parser.logging.debug}});let r=new Object3D;return r.name="OBJLoader2ParallelDummy",r}return OBJLoader2.prototype.parse.call(this,e)}});export{OBJLoader2Parallel};
//# sourceMappingURL=/sm/bb46215d059acfc0d83ee054f9594ee4276898b809c71e5d6fc9737ef6561d27.map