/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/misc/Volume.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Matrix3,Matrix4,Vector3}from"../../../build/three.module.js";import{VolumeSlice}from"../misc/VolumeSlice.js";var Volume=function(t,e,n,i,a){if(arguments.length>0){switch(this.xLength=Number(t)||1,this.yLength=Number(e)||1,this.zLength=Number(n)||1,i){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":this.data=new Uint8Array(a);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(a);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(a);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(a);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(a);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(a);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw"Error in Volume constructor : this type is not supported in JavaScript";case"Float32":case"float32":case"float":this.data=new Float32Array(a);break;case"Float64":case"float64":case"double":this.data=new Float64Array(a);break;default:this.data=new Uint8Array(a)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw"Error in Volume constructor, lengths are not matching arrayBuffer size"}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new Matrix3,this.matrix.identity();var s=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return s},set:function(t){s=t,this.sliceList.forEach(function(t){t.geometryNeedsUpdate=!0})}});var r=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return r},set:function(t){r=t,this.sliceList.forEach(function(t){t.geometryNeedsUpdate=!0})}}),this.sliceList=[]};Volume.prototype={constructor:Volume,getData:function(t,e,n){return this.data[n*this.xLength*this.yLength+e*this.xLength+t]},access:function(t,e,n){return n*this.xLength*this.yLength+e*this.xLength+t},reverseAccess:function(t){var e=Math.floor(t/(this.yLength*this.xLength)),n=Math.floor((t-e*this.yLength*this.xLength)/this.xLength);return[t-e*this.yLength*this.xLength-n*this.xLength,n,e]},map:function(t,e){var n=this.data.length;e=e||this;for(var i=0;i<n;i++)this.data[i]=t.call(e,this.data[i],i,this.data);return this},extractPerpendicularPlane:function(t,e){var n,i,a,s,r,o,h,c,u=(new Matrix4).identity(),g=this,l=new Vector3,d=new Vector3,f=new Vector3,m=new Vector3(this.xLength,this.yLength,this.zLength);switch(t){case"x":l.set(1,0,0),d.set(0,0,-1),f.set(0,-1,0),r=this.spacing[2],o=this.spacing[1],c=new Vector3(e,0,0),u.multiply((new Matrix4).makeRotationY(Math.PI/2)),h=(g.RASDimensions[0]-1)/2,u.setPosition(new Vector3(e-h,0,0));break;case"y":l.set(0,1,0),d.set(1,0,0),f.set(0,0,1),r=this.spacing[0],o=this.spacing[2],c=new Vector3(0,e,0),u.multiply((new Matrix4).makeRotationX(-Math.PI/2)),h=(g.RASDimensions[1]-1)/2,u.setPosition(new Vector3(0,e-h,0));break;case"z":default:l.set(0,0,1),d.set(1,0,0),f.set(0,-1,0),r=this.spacing[0],o=this.spacing[1],c=new Vector3(0,0,e),h=(g.RASDimensions[2]-1)/2,u.setPosition(new Vector3(0,0,e-h))}d.applyMatrix4(g.inverseMatrix).normalize(),d.argVar="i",f.applyMatrix4(g.inverseMatrix).normalize(),f.argVar="j",l.applyMatrix4(g.inverseMatrix).normalize(),n=Math.floor(Math.abs(d.dot(m))),i=Math.floor(Math.abs(f.dot(m))),a=Math.abs(n*r),s=Math.abs(i*o),c=Math.abs(Math.round(c.applyMatrix4(g.inverseMatrix).dot(l)));var p=[new Vector3(1,0,0),new Vector3(0,1,0),new Vector3(0,0,1)],x=[d,f,l].find(function(t){return Math.abs(t.dot(p[0]))>.9}),y=[d,f,l].find(function(t){return Math.abs(t.dot(p[1]))>.9}),L=[d,f,l].find(function(t){return Math.abs(t.dot(p[2]))>.9});return{iLength:n,jLength:i,sliceAccess:function(t,e){var n=x===l?c:"i"===x.argVar?t:e,i=y===l?c:"i"===y.argVar?t:e,a=L===l?c:"i"===L.argVar?t:e,s=x.dot(p[0])>0?n:g.xLength-1-n,r=y.dot(p[1])>0?i:g.yLength-1-i,o=L.dot(p[2])>0?a:g.zLength-1-a;return g.access(s,r,o)},matrix:u,planeWidth:a,planeHeight:s}},extractSlice:function(t,e){var n=new VolumeSlice(this,e,t);return this.sliceList.push(n),n},repaintAllSlices:function(){return this.sliceList.forEach(function(t){t.repaint()}),this},computeMinMax:function(){var t=1/0,e=-1/0,n=this.data.length,i=0;for(i=0;i<n;i++)if(!isNaN(this.data[i])){var a=this.data[i];t=Math.min(t,a),e=Math.max(e,a)}return this.min=t,this.max=e,[t,e]}};export{Volume};
//# sourceMappingURL=/sm/ce7f303a9c4a3bd0411cd5045d22d621f7b1be6d528f31148ca5edc9860b120a.map