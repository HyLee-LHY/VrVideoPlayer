/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/misc/MD2Character.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{AnimationMixer,Box3,Mesh,MeshLambertMaterial,Object3D,TextureLoader,UVMapping,sRGBEncoding}from"../../../build/three.module.js";import{MD2Loader}from"../loaders/MD2Loader.js";var MD2Character=function(){var e=this;function i(e,i){for(var t=new TextureLoader,a=[],o=0;o<i.length;o++)a[o]=t.load(e+i[o],s),a[o].mapping=UVMapping,a[o].name=i[o],a[o].encoding=sRGBEncoding;return a}function t(e,i){var t=new MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),s=new MeshLambertMaterial({color:16777215,wireframe:!1,map:i,morphTargets:!0,morphNormals:!0}),a=new Mesh(e,s);return a.rotation.y=-Math.PI/2,a.castShadow=!0,a.receiveShadow=!0,a.materialTexture=s,a.materialWireframe=t,a}function s(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}this.scale=1,this.animationFPS=6,this.root=new Object3D,this.meshBody=null,this.meshWeapon=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.activeAnimation=null,this.mixer=null,this.onLoadComplete=function(){},this.loadCounter=0,this.loadParts=function(a){this.loadCounter=2*a.weapons.length+a.skins.length+1;for(var o=[],n=0;n<a.weapons.length;n++)o[n]=a.weapons[n][1];this.skinsBody=i(a.baseUrl+"skins/",a.skins),this.skinsWeapon=i(a.baseUrl+"skins/",o);var h=new MD2Loader;h.load(a.baseUrl+a.body,function(i){var a=new Box3;a.setFromBufferAttribute(i.attributes.position),e.root.position.y=-e.scale*a.min.y;var o=t(i,e.skinsBody[0]);o.scale.set(e.scale,e.scale,e.scale),e.root.add(o),e.meshBody=o,e.meshBody.clipOffset=0,e.activeAnimationClipName=o.geometry.animations[0].name,e.mixer=new AnimationMixer(o),s()});var r=function(i,a){return function(o){var n=t(o,e.skinsWeapon[i]);n.scale.set(e.scale,e.scale,e.scale),n.visible=!1,n.name=a,e.root.add(n),e.weapons[i]=n,e.meshWeapon=n,s()}};for(n=0;n<a.weapons.length;n++)h.load(a.baseUrl+a.weapons[n][0],r(n,a.weapons[n][0]))},this.setPlaybackRate=function(e){this.mixer.timeScale=0!==e?1/e:0},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e])},this.setWeapon=function(i){for(var t=0;t<this.weapons.length;t++)this.weapons[t].visible=!1;var s=this.weapons[i];s&&(s.visible=!0,this.meshWeapon=s,e.syncWeaponAnimation())},this.setAnimation=function(i){if(this.meshBody){this.meshBody.activeAction&&(this.meshBody.activeAction.stop(),this.meshBody.activeAction=null);var t=this.mixer.clipAction(i,this.meshBody);t&&(this.meshBody.activeAction=t.play())}e.activeClipName=i,e.syncWeaponAnimation()},this.syncWeaponAnimation=function(){var i=e.activeClipName;if(e.meshWeapon){this.meshWeapon.activeAction&&(this.meshWeapon.activeAction.stop(),this.meshWeapon.activeAction=null);var t=this.mixer.clipAction(i,this.meshWeapon);t&&(this.meshWeapon.activeAction=t.syncWith(this.meshBody.activeAction).play())}},this.update=function(e){this.mixer&&this.mixer.update(e)}};export{MD2Character};
//# sourceMappingURL=/sm/5dac5607886ebebea44ea932e550433139e053028429b68329019b87a505068d.map