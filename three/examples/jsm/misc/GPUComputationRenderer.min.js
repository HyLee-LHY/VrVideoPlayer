/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/misc/GPUComputationRenderer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Camera,ClampToEdgeWrapping,DataTexture,FloatType,HalfFloatType,Mesh,NearestFilter,PlaneBufferGeometry,RGBAFormat,Scene,ShaderMaterial,WebGLRenderTarget}from"../../../build/three.module.js";var GPUComputationRenderer=function(e,r,t){this.variables=[],this.currentTextureIndex=0;var a=new Scene,n=new Camera;n.position.z=1;var i={passThruTexture:{value:null}},s=d("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",i),u=new Mesh(new PlaneBufferGeometry(2,2),s);function l(t){t.defines.resolution="vec2( "+e.toFixed(1)+", "+r.toFixed(1)+" )"}function d(e,r){var t=new ShaderMaterial({uniforms:r=r||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return l(t),t}a.add(u),this.addVariable=function(e,r,t){var a={name:e,initialValueTexture:t,material:this.createShaderMaterial(r),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:NearestFilter,magFilter:NearestFilter};return this.variables.push(a),a},this.setVariableDependencies=function(e,r){e.dependencies=r},this.init=function(){if(!t.capabilities.isWebGL2&&!t.extensions.get("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===t.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var a=0;a<this.variables.length;a++){var n=this.variables[a];n.renderTargets[0]=this.createRenderTarget(e,r,n.wrapS,n.wrapT,n.minFilter,n.magFilter),n.renderTargets[1]=this.createRenderTarget(e,r,n.wrapS,n.wrapT,n.minFilter,n.magFilter),this.renderTexture(n.initialValueTexture,n.renderTargets[0]),this.renderTexture(n.initialValueTexture,n.renderTargets[1]);var i=n.material,s=i.uniforms;if(null!==n.dependencies)for(var u=0;u<n.dependencies.length;u++){var l=n.dependencies[u];if(l.name!==n.name){for(var d=!1,o=0;o<this.variables.length;o++)if(l.name===this.variables[o].name){d=!0;break}if(!d)return"Variable dependency not found. Variable="+n.name+", dependency="+l.name}s[l.name]={value:null},i.fragmentShader="\nuniform sampler2D "+l.name+";\n"+i.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var e=this.currentTextureIndex,r=0===this.currentTextureIndex?1:0,t=0,a=this.variables.length;t<a;t++){var n=this.variables[t];if(null!==n.dependencies)for(var i=n.material.uniforms,s=0,u=n.dependencies.length;s<u;s++){var l=n.dependencies[s];i[l.name].value=l.renderTargets[e].texture}this.doRenderTarget(n.material,n.renderTargets[r])}this.currentTextureIndex=r},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.addResolutionDefine=l,this.createShaderMaterial=d,this.createRenderTarget=function(t,a,n,i,s,u){return new WebGLRenderTarget(t=t||e,a=a||r,{wrapS:n=n||ClampToEdgeWrapping,wrapT:i=i||ClampToEdgeWrapping,minFilter:s=s||NearestFilter,magFilter:u=u||NearestFilter,format:RGBAFormat,type:/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?HalfFloatType:FloatType,stencilBuffer:!1,depthBuffer:!1})},this.createTexture=function(){var t=new Float32Array(e*r*4);return new DataTexture(t,e,r,RGBAFormat,FloatType)},this.renderTexture=function(e,r){i.passThruTexture.value=e,this.doRenderTarget(s,r),i.passThruTexture.value=null},this.doRenderTarget=function(e,r){var i=t.getRenderTarget();u.material=e,t.setRenderTarget(r),t.render(a,n),u.material=s,t.setRenderTarget(i)}};export{GPUComputationRenderer};
//# sourceMappingURL=/sm/83aea788771b050e67d23b7f6561fee08aee7718eb03187114e95764151ee516.map