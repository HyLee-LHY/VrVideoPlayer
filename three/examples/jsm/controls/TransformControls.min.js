/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/jsm/controls/TransformControls.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{BoxBufferGeometry,BufferGeometry,Color,CylinderBufferGeometry,DoubleSide,Euler,Float32BufferAttribute,Line,LineBasicMaterial,Matrix4,Mesh,MeshBasicMaterial,Object3D,OctahedronBufferGeometry,PlaneBufferGeometry,Quaternion,Raycaster,SphereBufferGeometry,TorusBufferGeometry,Vector3}from"../../../build/three.module.js";var TransformControls=function(e,t){void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),Object3D.call(this),this.visible=!1,this.domElement=t;var o=new TransformControlsGizmo;this.add(o);var n=new TransformControlsPlane;this.add(n);var i=this;A("camera",e),A("object",void 0),A("enabled",!0),A("axis",null),A("mode","translate"),A("translationSnap",null),A("rotationSnap",null),A("scaleSnap",null),A("space","world"),A("size",1),A("dragging",!1),A("showX",!0),A("showY",!0),A("showZ",!0);var a={type:"change"},r={type:"mouseDown"},s={type:"mouseUp",mode:i.mode},l={type:"objectChange"},c=new Raycaster;function h(e,t,o){for(var n=t.intersectObject(e,!0),i=0;i<n.length;i++)if(n[i].object.visible||o)return n[i];return!1}var p=new Vector3,u=new Vector3,d=new Quaternion,m={X:new Vector3(1,0,0),Y:new Vector3(0,1,0),Z:new Vector3(0,0,1)},w=new Vector3,y=new Vector3,f=new Vector3,v=new Vector3,M=new Vector3,b=new Vector3,x=0,g=new Vector3,P=new Quaternion,X=new Vector3,B=new Vector3,Y=new Quaternion,Z=new Quaternion,E=new Vector3,S=new Vector3,L=new Quaternion,G=new Vector3,Q=new Vector3,I=new Quaternion,j=new Quaternion,C=new Vector3,T=new Vector3,z=new Vector3,V=new Quaternion,O=new Vector3;function A(e,t){var r=t;Object.defineProperty(i,e,{get:function(){return void 0!==r?r:t},set:function(t){r!==t&&(r=t,n[e]=t,o[e]=t,i.dispatchEvent({type:e+"-changed",value:t}),i.dispatchEvent(a))}}),i[e]=t,n[e]=t,o[e]=t}function F(e){if(document.pointerLockElement)return{x:0,y:0,button:e.button};var o=e.changedTouches?e.changedTouches[0]:e,n=t.getBoundingClientRect();return{x:(o.clientX-n.left)/n.width*2-1,y:-(o.clientY-n.top)/n.height*2+1,button:e.button}}function k(e){i.enabled&&i.pointerHover(F(e))}function D(e){i.enabled&&(document.addEventListener("mousemove",q,!1),i.pointerHover(F(e)),i.pointerDown(F(e)))}function q(e){i.enabled&&i.pointerMove(F(e))}function W(e){i.enabled&&(document.removeEventListener("mousemove",q,!1),i.pointerUp(F(e)))}A("worldPosition",Q),A("worldPositionStart",S),A("worldQuaternion",I),A("worldQuaternionStart",L),A("cameraPosition",g),A("cameraQuaternion",P),A("pointStart",w),A("pointEnd",y),A("rotationAxis",v),A("rotationAngle",x),A("eye",T),t.addEventListener("mousedown",D,!1),t.addEventListener("touchstart",D,!1),t.addEventListener("mousemove",k,!1),t.addEventListener("touchmove",k,!1),t.addEventListener("touchmove",q,!1),document.addEventListener("mouseup",W,!1),t.addEventListener("touchend",W,!1),t.addEventListener("touchcancel",W,!1),t.addEventListener("touchleave",W,!1),this.dispose=function(){t.removeEventListener("mousedown",D),t.removeEventListener("touchstart",D),t.removeEventListener("mousemove",k),document.removeEventListener("mousemove",q),t.removeEventListener("touchmove",k),t.removeEventListener("touchmove",q),document.removeEventListener("mouseup",W),t.removeEventListener("touchend",W),t.removeEventListener("touchcancel",W),t.removeEventListener("touchleave",W),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(B,Y,E),this.object.matrixWorld.decompose(Q,I,C),Z.copy(Y).inverse(),j.copy(I).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(g,P,X),T.copy(g).sub(Q).normalize(),Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)){c.setFromCamera(e,this.camera);var t=h(o.picker[this.mode],c);this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(!(void 0===this.object||!0===this.dragging||void 0!==e.button&&0!==e.button||0!==e.button&&void 0!==e.button||null===this.axis)){c.setFromCamera(e,this.camera);var t=h(n,c,!0);if(t){var o=this.space;if("scale"===this.mode?o="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(o="world"),"local"===o&&"rotate"===this.mode){var i=this.rotationSnap;"X"===this.axis&&i&&(this.object.rotation.x=Math.round(this.object.rotation.x/i)*i),"Y"===this.axis&&i&&(this.object.rotation.y=Math.round(this.object.rotation.y/i)*i),"Z"===this.axis&&i&&(this.object.rotation.z=Math.round(this.object.rotation.z/i)*i)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),z.copy(this.object.position),V.copy(this.object.quaternion),O.copy(this.object.scale),this.object.matrixWorld.decompose(S,L,G),w.copy(t.point).sub(S)}this.dragging=!0,r.mode=this.mode,this.dispatchEvent(r)}},this.pointerMove=function(e){var t=this.axis,o=this.mode,i=this.object,r=this.space;if("scale"===o?r="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(r="world"),void 0!==i&&null!==t&&!1!==this.dragging&&(void 0===e.button||0===e.button)){c.setFromCamera(e,this.camera);var s=h(n,c,!0);if(s){if(y.copy(s.point).sub(S),"translate"===o)f.copy(y).sub(w),"local"===r&&"XYZ"!==t&&f.applyQuaternion(j),-1===t.indexOf("X")&&(f.x=0),-1===t.indexOf("Y")&&(f.y=0),-1===t.indexOf("Z")&&(f.z=0),"local"===r&&"XYZ"!==t?f.applyQuaternion(V).divide(E):f.applyQuaternion(Z).divide(E),i.position.copy(f).add(z),this.translationSnap&&("local"===r&&(i.position.applyQuaternion(d.copy(V).inverse()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(V)),"world"===r&&(i.parent&&i.position.add(p.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(p.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===o){if(-1!==t.search("XYZ")){var g=y.length()/w.length();y.dot(w)<0&&(g*=-1),u.set(g,g,g)}else p.copy(w),u.copy(y),p.applyQuaternion(j),u.applyQuaternion(j),u.divide(p),-1===t.search("X")&&(u.x=1),-1===t.search("Y")&&(u.y=1),-1===t.search("Z")&&(u.z=1);i.scale.copy(O).multiply(u),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===o){f.copy(y).sub(w);var P=20/Q.distanceTo(p.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(v.copy(T),x=y.angleTo(w),M.copy(w).normalize(),b.copy(y).normalize(),x*=b.cross(M).dot(T)<0?1:-1):"XYZE"===t?(v.copy(f).cross(T).normalize(),x=f.dot(p.copy(v).cross(this.eye))*P):"X"!==t&&"Y"!==t&&"Z"!==t||(v.copy(m[t]),p.copy(m[t]),"local"===r&&p.applyQuaternion(I),x=f.dot(p.cross(T).normalize())*P),this.rotationSnap&&(x=Math.round(x/this.rotationSnap)*this.rotationSnap),this.rotationAngle=x,"local"===r&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(V),i.quaternion.multiply(d.setFromAxisAngle(v,x)).normalize()):(v.applyQuaternion(Z),i.quaternion.copy(d.setFromAxisAngle(v,x)),i.quaternion.multiply(V).normalize())}this.dispatchEvent(a),this.dispatchEvent(l)}}},this.pointerUp=function(e){void 0!==e.button&&0!==e.button||(this.dragging&&null!==this.axis&&(s.mode=this.mode,this.dispatchEvent(s)),this.dragging=!1,void 0===e.button&&(this.axis=null))},this.getMode=function(){return i.mode},this.setMode=function(e){i.mode=e},this.setTranslationSnap=function(e){i.translationSnap=e},this.setRotationSnap=function(e){i.rotationSnap=e},this.setScaleSnap=function(e){i.scaleSnap=e},this.setSize=function(e){i.size=e},this.setSpace=function(e){i.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};TransformControls.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:TransformControls,isTransformControls:!0});var TransformControlsGizmo=function(){"use strict";Object3D.call(this),this.type="TransformControlsGizmo";var e=new MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide,fog:!1}),t=new LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),o=e.clone();o.opacity=.15;var n=e.clone();n.opacity=.33;var i=e.clone();i.color.set(16711680);var a=e.clone();a.color.set(65280);var r=e.clone();r.color.set(255);var s=e.clone();s.opacity=.25;var l=s.clone();l.color.set(16776960);var c=s.clone();c.color.set(65535);var h=s.clone();h.color.set(16711935),e.clone().color.set(16776960);var p=t.clone();p.color.set(16711680);var u=t.clone();u.color.set(65280);var d=t.clone();d.color.set(255);var m=t.clone();m.color.set(65535);var w=t.clone();w.color.set(16711935);var y=t.clone();y.color.set(16776960);var f=t.clone();f.color.set(7895160);var v=y.clone();v.opacity=.25;var M=new CylinderBufferGeometry(0,.05,.2,12,1,!1),b=new BoxBufferGeometry(.125,.125,.125),x=new BufferGeometry;x.setAttribute("position",new Float32BufferAttribute([0,0,0,1,0,0],3));var g,P=function(e,t){for(var o=new BufferGeometry,n=[],i=0;i<=64*t;++i)n.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e);return o.setAttribute("position",new Float32BufferAttribute(n,3)),o},X={X:[[new Mesh(M,i),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Mesh(M,i),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Line(x,p)]],Y:[[new Mesh(M,a),[0,1,0],null,null,"fwd"],[new Mesh(M,a),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Line(x,u),null,[0,0,Math.PI/2]]],Z:[[new Mesh(M,r),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Mesh(M,r),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Line(x,d),null,[0,-Math.PI/2,0]]],XYZ:[[new Mesh(new OctahedronBufferGeometry(.1,0),s.clone()),[0,0,0],[0,0,0]]],XY:[[new Mesh(new PlaneBufferGeometry(.295,.295),l.clone()),[.15,.15,0]],[new Line(x,y),[.18,.3,0],null,[.125,1,1]],[new Line(x,y),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(new PlaneBufferGeometry(.295,.295),c.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new Line(x,m),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Line(x,m),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(new PlaneBufferGeometry(.295,.295),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new Line(x,w),[.18,0,.3],null,[.125,1,1]],[new Line(x,w),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},B={X:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),o),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),o),[0,.6,0]]],Z:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),o),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Mesh(new OctahedronBufferGeometry(.2,0),o)]],XY:[[new Mesh(new PlaneBufferGeometry(.4,.4),o),[.2,.2,0]]],YZ:[[new Mesh(new PlaneBufferGeometry(.4,.4),o),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Mesh(new PlaneBufferGeometry(.4,.4),o),[.2,0,.2],[-Math.PI/2,0,0]]]},Y={START:[[new Mesh(new OctahedronBufferGeometry(.01,2),n),null,null,null,"helper"]],END:[[new Mesh(new OctahedronBufferGeometry(.01,2),n),null,null,null,"helper"]],DELTA:[[new Line((g=new BufferGeometry,g.setAttribute("position",new Float32BufferAttribute([0,0,0,1,1,1],3)),g),n),null,null,null,"helper"]],X:[[new Line(x,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(x,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(x,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Z={X:[[new Line(P(1,.5),p)],[new Mesh(new OctahedronBufferGeometry(.04,0),i),[0,0,.99],null,[1,3,1]]],Y:[[new Line(P(1,.5),u),null,[0,0,-Math.PI/2]],[new Mesh(new OctahedronBufferGeometry(.04,0),a),[0,0,.99],null,[3,1,1]]],Z:[[new Line(P(1,.5),d),null,[0,Math.PI/2,0]],[new Mesh(new OctahedronBufferGeometry(.04,0),r),[.99,0,0],null,[1,3,1]]],E:[[new Line(P(1.25,1),v),null,[0,Math.PI/2,0]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),v),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),v),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),v),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),v),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Line(P(1,1),f),null,[0,Math.PI/2,0]]]},E={AXIS:[[new Line(x,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},S={X:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),o),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),o),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),o),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mesh(new TorusBufferGeometry(1.25,.1,2,24),o)]],XYZE:[[new Mesh(new SphereBufferGeometry(.7,10,8),o)]]},L={X:[[new Mesh(b,i),[.8,0,0],[0,0,-Math.PI/2]],[new Line(x,p),null,null,[.8,1,1]]],Y:[[new Mesh(b,a),[0,.8,0]],[new Line(x,u),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Mesh(b,r),[0,0,.8],[Math.PI/2,0,0]],[new Line(x,d),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Mesh(b,l),[.85,.85,0],null,[2,2,.2]],[new Line(x,y),[.855,.98,0],null,[.125,1,1]],[new Line(x,y),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(b,c),[0,.85,.85],null,[.2,2,2]],[new Line(x,m),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Line(x,m),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(b,h),[.85,0,.85],null,[2,.2,2]],[new Line(x,w),[.855,0,.98],null,[.125,1,1]],[new Line(x,w),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),s.clone()),[1.1,0,0]]],XYZY:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),s.clone()),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),s.clone()),[0,0,1.1]]]},G={X:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),o),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),o),[0,.5,0]]],Z:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),o),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Mesh(b,o),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Mesh(b,o),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Mesh(b,o),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),o),[1.1,0,0]]],XYZY:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),o),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),o),[0,0,1.1]]]},Q={X:[[new Line(x,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(x,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(x,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},I=function(e){var t=new Object3D;for(var o in e)for(var n=e[o].length;n--;){var i=e[o][n][0].clone(),a=e[o][n][1],r=e[o][n][2],s=e[o][n][3],l=e[o][n][4];i.name=o,i.tag=l,a&&i.position.set(a[0],a[1],a[2]),r&&i.rotation.set(r[0],r[1],r[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();var c=i.geometry.clone();c.applyMatrix4(i.matrix),i.geometry=c,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t},j=new Vector3(0,0,0),C=new Euler,T=new Vector3(0,1,0),z=new Vector3(0,0,0),V=new Matrix4,O=new Quaternion,A=new Quaternion,F=new Quaternion,k=new Vector3(1,0,0),D=new Vector3(0,1,0),q=new Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=I(X)),this.add(this.gizmo.rotate=I(Z)),this.add(this.gizmo.scale=I(L)),this.add(this.picker.translate=I(B)),this.add(this.picker.rotate=I(S)),this.add(this.picker.scale=I(G)),this.add(this.helper.translate=I(Y)),this.add(this.helper.rotate=I(E)),this.add(this.helper.scale=I(Q)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:F;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var o=[];o=(o=(o=o.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var n=0;n<o.length;n++){var i,a=o[n];if(a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition),i=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(i*this.size/7),"helper"!==a.tag){if(a.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==a.name&&"XYZX"!==a.name||Math.abs(T.copy(k).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Y"!==a.name&&"XYZY"!==a.name||Math.abs(T.copy(D).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Z"!==a.name&&"XYZZ"!==a.name||Math.abs(T.copy(q).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XY"===a.name&&Math.abs(T.copy(q).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"YZ"===a.name&&Math.abs(T.copy(k).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XZ"===a.name&&Math.abs(T.copy(D).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),-1!==a.name.search("X")&&(T.copy(k).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.x*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Y")&&(T.copy(D).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.y*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Z")&&(T.copy(q).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.z*=-1:"bwd"===a.tag&&(a.visible=!1))}else"rotate"===this.mode&&(A.copy(t),T.copy(this.eye).applyQuaternion(O.copy(t).inverse()),-1!==a.name.search("E")&&a.quaternion.setFromRotationMatrix(V.lookAt(this.eye,z,D)),"X"===a.name&&(O.setFromAxisAngle(k,Math.atan2(-T.y,T.z)),O.multiplyQuaternions(A,O),a.quaternion.copy(O)),"Y"===a.name&&(O.setFromAxisAngle(D,Math.atan2(T.x,T.z)),O.multiplyQuaternions(A,O),a.quaternion.copy(O)),"Z"===a.name&&(O.setFromAxisAngle(q,Math.atan2(T.y,T.x)),O.multiplyQuaternions(A,O),a.quaternion.copy(O)));a.visible=a.visible&&(-1===a.name.indexOf("X")||this.showX),a.visible=a.visible&&(-1===a.name.indexOf("Y")||this.showY),a.visible=a.visible&&(-1===a.name.indexOf("Z")||this.showZ),a.visible=a.visible&&(-1===a.name.indexOf("E")||this.showX&&this.showY&&this.showZ),a.material._opacity=a.material._opacity||a.material.opacity,a.material._color=a.material._color||a.material.color.clone(),a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled?this.axis&&(a.name===this.axis?(a.material.opacity=1,a.material.color.lerp(new Color(1,1,1),.5)):this.axis.split("").some(function(e){return a.name===e})?(a.material.opacity=1,a.material.color.lerp(new Color(1,1,1),.5)):(a.material.opacity*=.25,a.material.color.lerp(new Color(1,1,1),.5))):(a.material.opacity*=.5,a.material.color.lerp(new Color(1,1,1),.5))}else a.visible=!1,"AXIS"===a.name?(a.position.copy(this.worldPositionStart),a.visible=!!this.axis,"X"===this.axis&&(O.setFromEuler(C.set(0,0,0)),a.quaternion.copy(t).multiply(O),Math.abs(T.copy(k).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"Y"===this.axis&&(O.setFromEuler(C.set(0,0,Math.PI/2)),a.quaternion.copy(t).multiply(O),Math.abs(T.copy(D).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"Z"===this.axis&&(O.setFromEuler(C.set(0,Math.PI/2,0)),a.quaternion.copy(t).multiply(O),Math.abs(T.copy(q).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"XYZE"===this.axis&&(O.setFromEuler(C.set(0,Math.PI/2,0)),T.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(V.lookAt(z,T,D)),a.quaternion.multiply(O),a.visible=this.dragging),"E"===this.axis&&(a.visible=!1)):"START"===a.name?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):"END"===a.name?(a.position.copy(this.worldPosition),a.visible=this.dragging):"DELTA"===a.name?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),j.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),j.applyQuaternion(this.worldQuaternionStart.clone().inverse()),a.scale.copy(j),a.visible=this.dragging):(a.quaternion.copy(t),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=-1!==this.axis.search(a.name)))}Object3D.prototype.updateMatrixWorld.call(this)}};TransformControlsGizmo.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:TransformControlsGizmo,isTransformControlsGizmo:!0});var TransformControlsPlane=function(){"use strict";Mesh.call(this,new PlaneBufferGeometry(1e5,1e5,2,2),new MeshBasicMaterial({visible:!1,wireframe:!0,side:DoubleSide,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new Vector3(1,0,0),t=new Vector3(0,1,0),o=new Vector3(0,0,1),n=new Vector3,i=new Vector3,a=new Vector3,r=new Matrix4,s=new Quaternion;this.updateMatrixWorld=function(){var l=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(l="local"),e.set(1,0,0).applyQuaternion("local"===l?this.worldQuaternion:s),t.set(0,1,0).applyQuaternion("local"===l?this.worldQuaternion:s),o.set(0,0,1).applyQuaternion("local"===l?this.worldQuaternion:s),a.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":a.copy(this.eye).cross(e),i.copy(e).cross(a);break;case"Y":a.copy(this.eye).cross(t),i.copy(t).cross(a);break;case"Z":a.copy(this.eye).cross(o),i.copy(o).cross(a);break;case"XY":i.copy(o);break;case"YZ":i.copy(e);break;case"XZ":a.copy(o),i.copy(t);break;case"XYZ":case"E":i.set(0,0,0)}break;case"rotate":default:i.set(0,0,0)}0===i.length()?this.quaternion.copy(this.cameraQuaternion):(r.lookAt(n.set(0,0,0),i,a),this.quaternion.setFromRotationMatrix(r)),Object3D.prototype.updateMatrixWorld.call(this)}};TransformControlsPlane.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:TransformControlsPlane,isTransformControlsPlane:!0});export{TransformControls,TransformControlsGizmo,TransformControlsPlane};
//# sourceMappingURL=/sm/72b2e3615fbc235e53795c4f1cb0d4ae0ab7cf1173222dc03beaa376b269f6c9.map