/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/js/renderers/Projector.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
console.warn("THREE.Projector: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/index.html#manual/en/introduction/Import-via-modules."),THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){var e,r,t,i,o,n,a,s,l,c,p,u=[],E=0,d=[],f=0,h=[],m=0,v=[],y=0,x=[],R=0,T={objects:[],lights:[],elements:[]},g=new THREE.Vector3,H=new THREE.Vector4,w=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),S=new THREE.Box3,M=new Array(3),b=new THREE.Matrix4,z=new THREE.Matrix4,V=new THREE.Matrix4,j=new THREE.Matrix3,O=new THREE.Frustum,C=new THREE.Vector4,L=new THREE.Vector4;this.projectVector=function(e,r){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(r)},this.unprojectVector=function(e,r){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(r)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var A=new function(){var e=[],r=[],i=[],n=null,s=new THREE.Matrix3;function l(e){var r=e.position,t=e.positionWorld,i=e.positionScreen;t.copy(r).applyMatrix4(p),i.copy(t).applyMatrix4(z);var o=1/i.w;i.x*=o,i.y*=o,i.z*=o,e.visible=i.x>=-1&&i.x<=1&&i.y>=-1&&i.y<=1&&i.z>=-1&&i.z<=1}function c(e,r,t){return!0===e.visible||!0===r.visible||!0===t.visible||(M[0]=e.positionScreen,M[1]=r.positionScreen,M[2]=t.positionScreen,w.intersectsBox(S.setFromPoints(M)))}function u(e,r,t){return(t.positionScreen.x-e.positionScreen.x)*(r.positionScreen.y-e.positionScreen.y)-(t.positionScreen.y-e.positionScreen.y)*(r.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(t){n=t,s.getNormalMatrix(n.matrixWorld),e.length=0,r.length=0,i.length=0},projectVertex:l,checkTriangleVisibility:c,checkBackfaceCulling:u,pushVertex:function(e,r,i){(t=B()).position.set(e,r,i),l(t)},pushNormal:function(r,t,i){e.push(r,t,i)},pushColor:function(e,t,i){r.push(e,t,i)},pushUv:function(e,r){i.push(e,r)},pushLine:function(e,t){var i=d[e],o=d[t];i.positionScreen.copy(i.position).applyMatrix4(V),o.positionScreen.copy(o.position).applyMatrix4(V),!0===I(i.positionScreen,o.positionScreen)&&(i.positionScreen.multiplyScalar(1/i.positionScreen.w),o.positionScreen.multiplyScalar(1/o.positionScreen.w),(a=P()).id=n.id,a.v1.copy(i),a.v2.copy(o),a.z=Math.max(i.positionScreen.z,o.positionScreen.z),a.renderOrder=n.renderOrder,a.material=n.material,n.material.vertexColors&&(a.vertexColors[0].fromArray(r,3*e),a.vertexColors[1].fromArray(r,3*t)),T.elements.push(a))},pushTriangle:function(t,a,l,p){var E=d[t],f=d[a],h=d[l];if(!1!==c(E,f,h)&&(p.side===THREE.DoubleSide||!0===u(E,f,h))){(o=N()).id=n.id,o.v1.copy(E),o.v2.copy(f),o.v3.copy(h),o.z=(E.positionScreen.z+f.positionScreen.z+h.positionScreen.z)/3,o.renderOrder=n.renderOrder,g.subVectors(h.position,f.position),H.subVectors(E.position,f.position),g.cross(H),o.normalModel.copy(g),o.normalModel.applyMatrix3(s).normalize();for(var m=0;m<3;m++){var v=o.vertexNormalsModel[m];v.fromArray(e,3*arguments[m]),v.applyMatrix3(s).normalize(),o.uvs[m].fromArray(i,2*arguments[m])}o.vertexNormalsLength=3,o.material=p,p.vertexColors&&o.color.fromArray(r,3*t),T.elements.push(o)}}}};function W(t){(e=function(){if(r===E){var e=new THREE.RenderableObject;return u.push(e),E++,r++,e}return u[r++]}()).id=t.id,e.object=t,g.setFromMatrixPosition(t.matrixWorld),g.applyMatrix4(z),e.z=g.z,e.renderOrder=t.renderOrder,T.objects.push(e)}function k(e,r,t){var i=1/e.w;e.z*=i,e.z>=-1&&e.z<=1&&((l=function(){if(c===R){var e=new THREE.RenderableSprite;return x.push(e),R++,c++,e}return x[c++]}()).id=r.id,l.x=e.x*i,l.y=e.y*i,l.z=e.z,l.renderOrder=r.renderOrder,l.object=r,l.rotation=r.rotation,l.scale.x=r.scale.x*Math.abs(l.x-(e.x+t.projectionMatrix.elements[0])/(e.w+t.projectionMatrix.elements[12])),l.scale.y=r.scale.y*Math.abs(l.y-(e.y+t.projectionMatrix.elements[5])/(e.w+t.projectionMatrix.elements[13])),l.material=r.material,T.elements.push(l))}function B(){if(i===f){var e=new THREE.RenderableVertex;return d.push(e),f++,i++,e}return d[i++]}function N(){if(n===m){var e=new THREE.RenderableFace;return h.push(e),m++,n++,e}return h[n++]}function P(){if(s===y){var e=new THREE.RenderableLine;return v.push(e),y++,s++,e}return v[s++]}function F(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.z!==r.z?r.z-e.z:e.id!==r.id?e.id-r.id:0}function I(e,r){var t=0,i=1,o=e.z+e.w,n=r.z+r.w,a=-e.z+e.w,s=-r.z+r.w;return o>=0&&n>=0&&a>=0&&s>=0||!(o<0&&n<0||a<0&&s<0)&&(o<0?t=Math.max(t,o/(o-n)):n<0&&(i=Math.min(i,o/(o-n))),a<0?t=Math.max(t,a/(a-s)):s<0&&(i=Math.min(i,a/(a-s))),!(i<t)&&(e.lerp(r,t),r.lerp(e,1-i),!0))}this.projectScene=function(e,t,l,u){n=0,s=0,c=0,T.elements.length=0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),b.copy(t.matrixWorldInverse),z.multiplyMatrices(t.projectionMatrix,b),O.setFromProjectionMatrix(z),r=0,T.objects.length=0,T.lights.length=0,function e(r){if(!1!==r.visible){if(r instanceof THREE.Light)T.lights.push(r);else if(r instanceof THREE.Mesh||r instanceof THREE.Line||r instanceof THREE.Points){if(!1===r.material.visible)return;if(!0===r.frustumCulled&&!1===O.intersectsObject(r))return;W(r)}else if(r instanceof THREE.Sprite){if(!1===r.material.visible)return;if(!0===r.frustumCulled&&!1===O.intersectsSprite(r))return;W(r)}for(var t=r.children,i=0,o=t.length;i<o;i++)e(t[i])}}(e),!0===l&&T.objects.sort(F);for(var E=T.objects,f=0,h=E.length;f<h;f++){var m=E[f].object,v=m.geometry;if(A.setObject(m),p=m.matrixWorld,i=0,m instanceof THREE.Mesh){if(v instanceof THREE.BufferGeometry){var y=m.material,x=Array.isArray(y),R=v.attributes,w=v.groups;if(void 0===R.position)continue;for(var S=0,M=(Me=R.position.array).length;S<M;S+=3){var G=Me[S],D=Me[S+1],U=Me[S+2];if(!0===y.morphTargets)for(var Y=v.morphAttributes.position,X=v.morphTargetsRelative,Z=m.morphTargetInfluences,q=0,J=Y.length;q<J;q++){if(0!==(le=Z[q])){var K=Y[q];X?(G+=K.getX(S/3)*le,D+=K.getY(S/3)*le,U+=K.getZ(S/3)*le):(G+=(K.getX(S/3)-Me[S])*le,D+=(K.getY(S/3)-Me[S+1])*le,U+=(K.getZ(S/3)-Me[S+2])*le)}}A.pushVertex(G,D,U)}if(void 0!==R.normal){var Q=R.normal.array;for(S=0,M=Q.length;S<M;S+=3)A.pushNormal(Q[S],Q[S+1],Q[S+2])}if(void 0!==R.color)for(S=0,M=(we=R.color.array).length;S<M;S+=3)A.pushColor(we[S],we[S+1],we[S+2]);if(void 0!==R.uv){var $=R.uv.array;for(S=0,M=$.length;S<M;S+=2)A.pushUv($[S],$[S+1])}if(null!==v.index){var _=v.index.array;if(w.length>0)for(var ee=0;ee<w.length;ee++){var re=w[ee];if(void 0!==(y=!0===x?m.material[re.materialIndex]:m.material))for(S=re.start,M=re.start+re.count;S<M;S+=3)A.pushTriangle(_[S],_[S+1],_[S+2],y)}else for(S=0,M=_.length;S<M;S+=3)A.pushTriangle(_[S],_[S+1],_[S+2],y)}else if(w.length>0)for(ee=0;ee<w.length;ee++){re=w[ee];if(void 0!==(y=!0===x?m.material[re.materialIndex]:m.material))for(S=re.start,M=re.start+re.count;S<M;S+=3)A.pushTriangle(S,S+1,S+2,y)}else for(S=0,M=Me.length/3;S<M;S+=3)A.pushTriangle(S,S+1,S+2,y)}else if(v instanceof THREE.Geometry){var te=v.vertices,ie=v.faces,oe=v.faceVertexUvs[0];j.getNormalMatrix(p);y=m.material,x=Array.isArray(y);for(var ne=0,ae=te.length;ne<ae;ne++){var se=te[ne];if(g.copy(se),!0===y.morphTargets)for(Y=v.morphTargets,Z=m.morphTargetInfluences,q=0,J=Y.length;q<J;q++){var le;if(0!==(le=Z[q])){var ce=(K=Y[q]).vertices[ne];g.x+=(ce.x-se.x)*le,g.y+=(ce.y-se.y)*le,g.z+=(ce.z-se.z)*le}}A.pushVertex(g.x,g.y,g.z)}for(var pe=0,ue=ie.length;pe<ue;pe++){var Ee=ie[pe];if(void 0!==(y=!0===x?m.material[Ee.materialIndex]:m.material)){var de=y.side,fe=d[Ee.a],he=d[Ee.b],me=d[Ee.c];if(!1!==A.checkTriangleVisibility(fe,he,me)){var ve=A.checkBackfaceCulling(fe,he,me);if(de!==THREE.DoubleSide){if(de===THREE.FrontSide&&!1===ve)continue;if(de===THREE.BackSide&&!0===ve)continue}(o=N()).id=m.id,o.v1.copy(fe),o.v2.copy(he),o.v3.copy(me),o.normalModel.copy(Ee.normal),!1!==ve||de!==THREE.BackSide&&de!==THREE.DoubleSide||o.normalModel.negate(),o.normalModel.applyMatrix3(j).normalize();for(var ye=Ee.vertexNormals,xe=0,Re=Math.min(ye.length,3);xe<Re;xe++){var Te=o.vertexNormalsModel[xe];Te.copy(ye[xe]),!1!==ve||de!==THREE.BackSide&&de!==THREE.DoubleSide||Te.negate(),Te.applyMatrix3(j).normalize()}o.vertexNormalsLength=ye.length;var ge=oe[pe];if(void 0!==ge)for(var He=0;He<3;He++)o.uvs[He].copy(ge[He]);o.color=Ee.color,o.material=y,o.z=(fe.positionScreen.z+he.positionScreen.z+me.positionScreen.z)/3,o.renderOrder=m.renderOrder,T.elements.push(o)}}}}}else if(m instanceof THREE.Line){if(V.multiplyMatrices(z,p),v instanceof THREE.BufferGeometry){if(void 0!==(R=v.attributes).position){for(S=0,M=(Me=R.position.array).length;S<M;S+=3)A.pushVertex(Me[S],Me[S+1],Me[S+2]);if(void 0!==R.color){var we;for(S=0,M=(we=R.color.array).length;S<M;S+=3)A.pushColor(we[S],we[S+1],we[S+2])}if(null!==v.index)for(S=0,M=(_=v.index.array).length;S<M;S+=2)A.pushLine(_[S],_[S+1]);else{var Se=m instanceof THREE.LineSegments?2:1;for(S=0,M=Me.length/3-1;S<M;S+=Se)A.pushLine(S,S+1)}}}else if(v instanceof THREE.Geometry){if(0===(te=m.geometry.vertices).length)continue;(fe=B()).positionScreen.copy(te[0]).applyMatrix4(V);for(Se=m instanceof THREE.LineSegments?2:1,ne=1,ae=te.length;ne<ae;ne++)(fe=B()).positionScreen.copy(te[ne]).applyMatrix4(V),(ne+1)%Se>0||(he=d[i-2],C.copy(fe.positionScreen),L.copy(he.positionScreen),!0===I(C,L)&&(C.multiplyScalar(1/C.w),L.multiplyScalar(1/L.w),(a=P()).id=m.id,a.v1.positionScreen.copy(C),a.v2.positionScreen.copy(L),a.z=Math.max(C.z,L.z),a.renderOrder=m.renderOrder,a.material=m.material,m.material.vertexColors&&(a.vertexColors[0].copy(m.geometry.colors[ne]),a.vertexColors[1].copy(m.geometry.colors[ne-1])),T.elements.push(a)))}}else if(m instanceof THREE.Points){if(V.multiplyMatrices(z,p),v instanceof THREE.Geometry)for(ne=0,ae=(te=m.geometry.vertices).length;ne<ae;ne++){se=te[ne];H.set(se.x,se.y,se.z,1),H.applyMatrix4(V),k(H,m,t)}else if(v instanceof THREE.BufferGeometry){if(void 0!==(R=v.attributes).position){var Me;for(S=0,M=(Me=R.position.array).length;S<M;S+=3)H.set(Me[S],Me[S+1],Me[S+2],1),H.applyMatrix4(V),k(H,m,t)}}}else m instanceof THREE.Sprite&&(m.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,m.matrixWorld),H.set(p.elements[12],p.elements[13],p.elements[14],1),H.applyMatrix4(z),k(H,m,t))}return!0===u&&T.elements.sort(F),T}};
//# sourceMappingURL=/sm/a39fd8ff0930ddacd21c22ed4dc990ba3393518bfcf36718d06ec893ca9cdd4c.map