/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/js/objects/Reflector.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
console.warn("THREE.Reflector: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/index.html#manual/en/introduction/Import-via-modules."),THREE.Reflector=function(e,t){THREE.Mesh.call(this,e),this.type="Reflector";var r=this,a=void 0!==(t=t||{}).color?new THREE.Color(t.color):new THREE.Color(8355711),o=t.textureWidth||512,n=t.textureHeight||512,i=t.clipBias||0,l=t.shader||THREE.Reflector.ReflectorShader,s=void 0!==t.encoding?t.encoding:THREE.LinearEncoding,d=new THREE.Plane,c=new THREE.Vector3,E=new THREE.Vector3,u=new THREE.Vector3,m=new THREE.Matrix4,f=new THREE.Vector3(0,0,-1),v=new THREE.Vector4,p=new THREE.Vector3,R=new THREE.Vector3,x=new THREE.Vector4,b=new THREE.Matrix4,T=new THREE.PerspectiveCamera,M={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1,encoding:s},h=new THREE.WebGLRenderTarget(o,n,M);THREE.MathUtils.isPowerOfTwo(o)&&THREE.MathUtils.isPowerOfTwo(n)||(h.texture.generateMipmaps=!1);var H=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});H.uniforms.tDiffuse.value=h.texture,H.uniforms.color.value=a,H.uniforms.textureMatrix.value=b,this.material=H,this.onBeforeRender=function(e,t,a){if(E.setFromMatrixPosition(r.matrixWorld),u.setFromMatrixPosition(a.matrixWorld),m.extractRotation(r.matrixWorld),c.set(0,0,1),c.applyMatrix4(m),p.subVectors(E,u),!(p.dot(c)>0)){p.reflect(c).negate(),p.add(E),m.extractRotation(a.matrixWorld),f.set(0,0,-1),f.applyMatrix4(m),f.add(u),R.subVectors(E,f),R.reflect(c).negate(),R.add(E),T.position.copy(p),T.up.set(0,1,0),T.up.applyMatrix4(m),T.up.reflect(c),T.lookAt(R),T.far=a.far,T.updateMatrixWorld(),T.projectionMatrix.copy(a.projectionMatrix),b.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),b.multiply(T.projectionMatrix),b.multiply(T.matrixWorldInverse),b.multiply(r.matrixWorld),d.setFromNormalAndCoplanarPoint(c,E),d.applyMatrix4(T.matrixWorldInverse),v.set(d.normal.x,d.normal.y,d.normal.z,d.constant);var o=T.projectionMatrix;x.x=(Math.sign(v.x)+o.elements[8])/o.elements[0],x.y=(Math.sign(v.y)+o.elements[9])/o.elements[5],x.z=-1,x.w=(1+o.elements[10])/o.elements[14],v.multiplyScalar(2/v.dot(x)),o.elements[2]=v.x,o.elements[6]=v.y,o.elements[10]=v.z+1-i,o.elements[14]=v.w,r.visible=!1;var n=e.getRenderTarget(),l=e.xr.enabled,s=e.shadowMap.autoUpdate;e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(h),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,T),e.xr.enabled=l,e.shadowMap.autoUpdate=s,e.setRenderTarget(n);var M=a.viewport;void 0!==M&&e.state.viewport(M),r.visible=!0}},this.getRenderTarget=function(){return h}},THREE.Reflector.prototype=Object.create(THREE.Mesh.prototype),THREE.Reflector.prototype.constructor=THREE.Reflector,THREE.Reflector.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};
//# sourceMappingURL=/sm/b543c9e73ebe7a01360169c02251a829b840fc871939340ab666c43fa42d4fda.map