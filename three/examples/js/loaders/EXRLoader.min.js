/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/three@0.117.1/examples/js/loaders/EXRLoader.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
console.warn("THREE.EXRLoader: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/index.html#manual/en/introduction/Import-via-modules."),THREE.EXRLoader=function(e){THREE.DataTextureLoader.call(this,e),this.type=THREE.FloatType},THREE.EXRLoader.prototype=Object.assign(Object.create(THREE.DataTextureLoader.prototype),{constructor:THREE.EXRLoader,parse:function(e){const r=65536,n=r>>3,t=14,a=65537,i=1<<t,o=i-1,l=32768,s=65535,f=59,u=63,c=2+u-f,v=8,h=4,p=4,w=2,d=1,y=0,E=1,g=0,m=1,b=2,R=Math.pow(2.7182818,2.2);var S=new DataView(new ArrayBuffer(8));function A(e){if(0===e)return[e,0];S.setFloat64(0,e);var r=S.getUint32(0)>>>20&2047;0===r&&(S.setFloat64(0,e*Math.pow(2,64)),r=(S.getUint32(0)>>>20&2047)-64);var n=r-1022;return[function(e,r){for(var n=Math.min(3,Math.ceil(Math.abs(r)/1023)),t=e,a=0;a<n;a++)t*=Math.pow(2,Math.floor((r+a)/n));return t}(e,-n),n]}const U={l:0,c:0,lc:0};function T(e,r,n,t,a){for(;n<e;)r=r<<8|ne(t,a),n+=8;n-=e,U.l=r>>n&(1<<e)-1,U.c=r,U.lc=n}const M=new Array(59);function I(e,r,n,t,i,o,l){for(var s=n,v=0,h=0;i<=o;i++){if(s.value-n.value>t)return!1;T(6,v,h,e,s);var p=U.l;if(v=U.c,h=U.lc,l[i]=p,p==u){if(s.value-n.value>t)throw"Something wrong with hufUnpackEncTable";T(8,v,h,e,s);var w=U.l+c;if(v=U.c,h=U.lc,i+w>o+1)throw"Something wrong with hufUnpackEncTable";for(;w--;)l[i++]=0;i--}else if(p>=f){if(i+(w=p-f+2)>o+1)throw"Something wrong with hufUnpackEncTable";for(;w--;)l[i++]=0;i--}}!function(e){for(var r=0;r<=58;++r)M[r]=0;for(r=0;r<a;++r)M[e[r]]+=1;var n=0;for(r=58;r>0;--r){var t=n+M[r]>>1;M[r]=n,n=t}for(r=0;r<a;++r){var i=e[r];i>0&&(e[r]=i|M[i]++<<6)}}(l)}function O(e){return 63&e}function C(e){return e>>6}const x={c:0,lc:0};function H(e,r,n,t){e=e<<8|ne(n,t),r+=8,x.c=e,x.lc=r}const z={c:0,lc:0};function N(e,r,n,t,a,i,o,l,s,f){if(e==r){t<8&&(H(n,t,a,o),n=x.c,t=x.lc);var u=n>>(t-=8);u=new Uint8Array([u])[0];if(s.value+u>f)return!1;for(var c=l[s.value-1];u-- >0;)l[s.value++]=c}else{if(!(s.value<f))return!1;l[s.value++]=e}z.c=n,z.lc=t}function P(e){return 65535&e}function F(e){var r=P(e);return r>32767?r-65536:r}const D={a:0,b:0};function L(e,r){var n=F(e),t=F(r),a=n+(1&t)+(t>>1),i=a,o=a-t;D.a=i,D.b=o}function k(e,r){var n=P(e),t=P(r),a=n-(t>>1)&s,i=t+a-l&s;D.a=i,D.b=a}function _(e,r,n,t,a,i,o){for(var l,s=o<16384,f=n>a?a:n,u=1;u<=f;)u<<=1;for(l=u>>=1,u>>=1;u>=1;){for(var c,v,h,p,w=0,d=w+i*(a-l),y=i*u,E=i*l,g=t*u,m=t*l;w<=d;w+=E){for(var b=w,R=w+t*(n-l);b<=R;b+=m){var S=b+g,A=(U=b+y)+g;s?(L(e[b+r],e[U+r]),c=D.a,h=D.b,L(e[S+r],e[A+r]),v=D.a,p=D.b,L(c,v),e[b+r]=D.a,e[S+r]=D.b,L(h,p),e[U+r]=D.a,e[A+r]=D.b):(k(e[b+r],e[U+r]),c=D.a,h=D.b,k(e[S+r],e[A+r]),v=D.a,p=D.b,k(c,v),e[b+r]=D.a,e[S+r]=D.b,k(h,p),e[U+r]=D.a,e[A+r]=D.b)}if(n&u){var U=b+y;s?L(e[b+r],e[U+r]):k(e[b+r],e[U+r]),c=D.a,e[U+r]=D.b,e[b+r]=c}}if(a&u)for(b=w,R=w+t*(n-l);b<=R;b+=m){S=b+g;s?L(e[b+r],e[S+r]):k(e[b+r],e[S+r]),c=D.a,e[S+r]=D.b,e[b+r]=c}l=u,u>>=1}return w}function B(e,r,n,l,s,f){var u=n.value,c=re(r,n),v=re(r,n);n.value+=4;var h=re(r,n);if(n.value+=4,c<0||c>=a||v<0||v>=a)throw"Something wrong with HUF_ENCSIZE";var p=new Array(a),w=new Array(i);if(function(e){for(var r=0;r<i;r++)e[r]={},e[r].len=0,e[r].lit=0,e[r].p=null}(w),I(e,0,n,l-(n.value-u),c,v,p),h>8*(l-(n.value-u)))throw"Something wrong with hufUncompress";!function(e,r,n,a){for(;r<=n;r++){var i=C(e[r]),o=O(e[r]);if(i>>o)throw"Invalid table entry";if(o>t){if((u=a[i>>o-t]).len)throw"Invalid table entry";if(u.lit++,u.p){var l=u.p;u.p=new Array(u.lit);for(var s=0;s<u.lit-1;++s)u.p[s]=l[s]}else u.p=new Array(1);u.p[u.lit-1]=r}else if(o){var f=0;for(s=1<<t-o;s>0;s--){var u;if((u=a[(i<<t-o)+f]).len||u.p)throw"Invalid table entry";u.len=o,u.lit=r,f++}}}}(p,c,v,w),function(e,r,n,a,i,l,s,f,u,c){for(var v=0,h=0,p=f,w=Math.trunc(i.value+(l+7)/8);i.value<w;)for(H(v,h,n,i),v=x.c,h=x.lc;h>=t;)if((g=r[v>>h-t&o]).len)h-=g.len,N(g.lit,s,v,h,n,0,i,u,c,p),v=z.c,h=z.lc;else{if(!g.p)throw"hufDecode issues";var d;for(d=0;d<g.lit;d++){for(var y=O(e[g.p[d]]);h<y&&i.value<w;)H(v,h,n,i),v=x.c,h=x.lc;if(h>=y&&C(e[g.p[d]])==(v>>h-y&(1<<y)-1)){h-=y,N(g.p[d],s,v,h,n,0,i,u,c,p),v=z.c,h=z.lc;break}}if(d==g.lit)throw"hufDecode issues"}var E=8-l&7;for(v>>=E,h-=E;h>0;){var g;if(!(g=r[v<<t-h&o]).len)throw"hufDecode issues";h-=g.len,N(g.lit,s,v,h,n,0,i,u,c,p),v=z.c,h=z.lc}}(p,w,e,0,n,h,v,f,s,{value:0})}function X(e){for(var r=1;r<e.length;r++){var n=e[r-1]+e[r]-128;e[r]=n}}function Z(e,r){for(var n=0,t=Math.floor((e.length+1)/2),a=0,i=e.length-1;!(a>i||(r[a++]=e[n++],a>i));)r[a++]=e[t++]}function V(e){for(var r=e.byteLength,n=new Array,t=0,a=new DataView(e);r>0;){var i=a.getInt8(t++);if(i<0){r-=(l=-i)+1;for(var o=0;o<l;o++)n.push(a.getUint8(t++))}else{var l=i;r-=2;var s=a.getUint8(t++);for(o=0;o<l+1;o++)n.push(s)}}return n}function W(e,r,n){for(var t,a=1;a<64;)65280==(t=r[e.value])?a=64:t>>8==255?a+=255&t:(n[a]=t,a++),e.value++}function Y(e){const r=.5*Math.cos(.7853975),n=.5*Math.cos(.196349375),t=.5*Math.cos(.39269875),a=.5*Math.cos(3*3.14159/16),i=.5*Math.cos(.981746875),o=.5*Math.cos(3*3.14159/8),l=.5*Math.cos(1.374445625);for(var s=new Array(4),f=new Array(4),u=new Array(4),c=new Array(4),v=0;v<8;++v){var h=8*v;s[0]=t*e[h+2],s[1]=o*e[h+2],s[2]=t*e[h+6],s[3]=o*e[h+6],f[0]=n*e[h+1]+a*e[h+3]+i*e[h+5]+l*e[h+7],f[1]=a*e[h+1]-l*e[h+3]-n*e[h+5]-i*e[h+7],f[2]=i*e[h+1]-n*e[h+3]+l*e[h+5]+a*e[h+7],f[3]=l*e[h+1]-i*e[h+3]+a*e[h+5]-n*e[h+7],u[0]=r*(e[h+0]+e[h+4]),u[3]=r*(e[h+0]-e[h+4]),u[1]=s[0]+s[3],u[2]=s[1]-s[2],c[0]=u[0]+u[1],c[1]=u[3]+u[2],c[2]=u[3]-u[2],c[3]=u[0]-u[1],e[h+0]=c[0]+f[0],e[h+1]=c[1]+f[1],e[h+2]=c[2]+f[2],e[h+3]=c[3]+f[3],e[h+4]=c[3]-f[3],e[h+5]=c[2]-f[2],e[h+6]=c[1]-f[1],e[h+7]=c[0]-f[0]}for(var p=0;p<8;++p)s[0]=t*e[16+p],s[1]=o*e[16+p],s[2]=t*e[48+p],s[3]=o*e[48+p],f[0]=n*e[8+p]+a*e[24+p]+i*e[40+p]+l*e[56+p],f[1]=a*e[8+p]-l*e[24+p]-n*e[40+p]-i*e[56+p],f[2]=i*e[8+p]-n*e[24+p]+l*e[40+p]+a*e[56+p],f[3]=l*e[8+p]-i*e[24+p]+a*e[40+p]-n*e[56+p],u[0]=r*(e[p]+e[32+p]),u[3]=r*(e[p]-e[32+p]),u[1]=s[0]+s[3],u[2]=s[1]-s[2],c[0]=u[0]+u[1],c[1]=u[3]+u[2],c[2]=u[3]-u[2],c[3]=u[0]-u[1],e[0+p]=c[0]+f[0],e[8+p]=c[1]+f[1],e[16+p]=c[2]+f[2],e[24+p]=c[3]+f[3],e[32+p]=c[3]-f[3],e[40+p]=c[2]-f[2],e[48+p]=c[1]-f[1],e[56+p]=c[0]-f[0]}function j(e){for(var r=0;r<64;++r){var n=e[0][r],t=e[1][r],a=e[2][r];e[0][r]=n+1.5747*a,e[1][r]=n-.1873*t-.4682*a,e[2][r]=n+1.8556*t}}function G(e,r,n){for(var t=0;t<64;++t)r[n+t]=le(q(e[t]))}function q(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(R,Math.abs(e)-1)}function J(e){var r=e.array.slice(e.offset.value,e.offset.value+e.size);"undefined"==typeof Zlib&&console.error("THREE.EXRLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var n=new Zlib.Inflate(r,{resize:!0,verify:!0}),t=new Uint8Array(n.decompress().buffer),a=new Uint8Array(t.length);return X(t),Z(t,a),new DataView(a.buffer)}function K(e){var r=e.viewer,n={value:e.offset.value},t=new Uint8Array(e.width*e.lines*(ve.channels.length*e.type*w)),a={version:ae(r,n),unknownUncompressedSize:ae(r,n),unknownCompressedSize:ae(r,n),acCompressedSize:ae(r,n),dcCompressedSize:ae(r,n),rleCompressedSize:ae(r,n),rleUncompressedSize:ae(r,n),rleRawSize:ae(r,n),totalAcUncompressedCount:ae(r,n),totalDcUncompressedCount:ae(r,n),acCompression:ae(r,n)};if(a.version<2)throw"EXRLoader.parse: "+ve.compression+" version "+a.version+" is unsupported";for(var i=new Array,o=se(r,n)-w;o>0;){var l=Q(r.buffer,n),s=te(r,n),f=s>>2&3,u=new Int8Array([(s>>4)-1])[0],c=te(r,n);i.push({name:l,index:u,type:c,compression:f}),o-=l.length+3}for(var v=ve.channels,h=new Array(e.channels),p=0;p<e.channels;++p){var d=h[p]={},R=v[p];d.name=R.name,d.compression=g,d.decoded=!1,d.type=R.pixelType,d.pLinear=R.pLinear,d.width=e.width,d.height=e.lines}for(var S={idx:new Array(3)},A=0;A<e.channels;++A)for(d=h[A],p=0;p<i.length;++p){var U=i[p];d.name==U.name&&(d.compression=U.compression,U.index>=0&&(S.idx[U.index]=A),d.offset=A)}if(a.acCompressedSize>0)switch(a.acCompression){case y:var T=new Uint16Array(a.totalAcUncompressedCount);B(e.array,r,n,a.acCompressedSize,T,a.totalAcUncompressedCount);break;case E:var M=e.array.slice(n.value,n.value+a.totalAcUncompressedCount),I=new Zlib.Inflate(M,{resize:!0,verify:!0});T=new Uint16Array(I.decompress().buffer);n.value+=a.totalAcUncompressedCount}if(a.dcCompressedSize>0){var O={array:e.array,offset:n,size:a.dcCompressedSize},C=new Uint16Array(J(O).buffer);n.value+=a.dcCompressedSize}if(a.rleRawSize>0){M=e.array.slice(n.value,n.value+a.rleCompressedSize);var x=V((I=new Zlib.Inflate(M,{resize:!0,verify:!0})).decompress().buffer);n.value+=a.rleCompressedSize}var H=0,z=new Array(h.length);for(p=0;p<z.length;++p)z[p]=new Array;for(var N=0;N<e.lines;++N)for(var P=0;P<h.length;++P)z[P].push(H),H+=h[P].width*e.type*w;!function(e,r,n,t,a,i){var o=new DataView(i.buffer),l=n[e.idx[0]].width,s=n[e.idx[0]].height,f=Math.floor(l/8),u=Math.ceil(l/8),c=Math.ceil(s/8),v=l-8*(u-1),h=s-8*(c-1),p={value:0},d=new Array(3),y=new Array(3),E=new Array(3),g=new Array(3),m=new Array(3);for(let n=0;n<3;++n)m[n]=r[e.idx[n]],d[n]=n<1?0:d[n-1]+u*c,y[n]=new Float32Array(64),E[n]=new Uint16Array(64),g[n]=new Uint16Array(64*u);for(let r=0;r<c;++r){var b=8;r==c-1&&(b=h);var R=8;for(let e=0;e<u;++e){e==u-1&&(R=v);for(let e=0;e<3;++e)E[e].fill(0),E[e][0]=a[d[e]++],W(p,t,E[e]),S=E[e],(A=y[e])[0]=oe(S[0]),A[1]=oe(S[1]),A[2]=oe(S[5]),A[3]=oe(S[6]),A[4]=oe(S[14]),A[5]=oe(S[15]),A[6]=oe(S[27]),A[7]=oe(S[28]),A[8]=oe(S[2]),A[9]=oe(S[4]),A[10]=oe(S[7]),A[11]=oe(S[13]),A[12]=oe(S[16]),A[13]=oe(S[26]),A[14]=oe(S[29]),A[15]=oe(S[42]),A[16]=oe(S[3]),A[17]=oe(S[8]),A[18]=oe(S[12]),A[19]=oe(S[17]),A[20]=oe(S[25]),A[21]=oe(S[30]),A[22]=oe(S[41]),A[23]=oe(S[43]),A[24]=oe(S[9]),A[25]=oe(S[11]),A[26]=oe(S[18]),A[27]=oe(S[24]),A[28]=oe(S[31]),A[29]=oe(S[40]),A[30]=oe(S[44]),A[31]=oe(S[53]),A[32]=oe(S[10]),A[33]=oe(S[19]),A[34]=oe(S[23]),A[35]=oe(S[32]),A[36]=oe(S[39]),A[37]=oe(S[45]),A[38]=oe(S[52]),A[39]=oe(S[54]),A[40]=oe(S[20]),A[41]=oe(S[22]),A[42]=oe(S[33]),A[43]=oe(S[38]),A[44]=oe(S[46]),A[45]=oe(S[51]),A[46]=oe(S[55]),A[47]=oe(S[60]),A[48]=oe(S[21]),A[49]=oe(S[34]),A[50]=oe(S[37]),A[51]=oe(S[47]),A[52]=oe(S[50]),A[53]=oe(S[56]),A[54]=oe(S[59]),A[55]=oe(S[61]),A[56]=oe(S[35]),A[57]=oe(S[36]),A[58]=oe(S[48]),A[59]=oe(S[49]),A[60]=oe(S[57]),A[61]=oe(S[58]),A[62]=oe(S[62]),A[63]=oe(S[63]),Y(y[e]);j(y);for(let r=0;r<3;++r)G(y[r],g[r],64*e)}let i=0;for(let t=0;t<3;++t){let a=n[e.idx[t]].type;for(let e=8*r;e<8*r+b;++e){i=m[t][e];for(let r=0;r<f;++r){let n=64*r+8*(7&e);o.setUint16(i+0*w*a,g[t][n+0],!0),o.setUint16(i+1*w*a,g[t][n+1],!0),o.setUint16(i+2*w*a,g[t][n+2],!0),o.setUint16(i+3*w*a,g[t][n+3],!0),o.setUint16(i+4*w*a,g[t][n+4],!0),o.setUint16(i+5*w*a,g[t][n+5],!0),o.setUint16(i+6*w*a,g[t][n+6],!0),o.setUint16(i+7*w*a,g[t][n+7],!0),i+=8*w*a}}if(f!=u)for(let e=8*r;e<8*r+b;++e){let r=m[t][e]+8*f*w*a,n=64*f+8*(7&e);for(let e=0;e<R;++e)o.setUint16(r+e*w*a,g[t][n+e],!0)}}}var S,A;for(var U=new Uint16Array(l),T=(o=new DataView(i.buffer),0);T<3;++T){n[e.idx[T]].decoded=!0;var M=n[e.idx[T]].type;if(2==n[T].type)for(var I=0;I<s;++I){let e=m[T][I];for(var O=0;O<l;++O)U[O]=o.getUint16(e+O*w*M,!0);for(O=0;O<l;++O)o.setFloat32(e+O*w*M,oe(U[O]),!0)}}}(S,z,h,T,C,t);for(p=0;p<h.length;++p){if(!(d=h[p]).decoded)switch(d.compression){case b:var F=0,D=0;for(N=0;N<e.lines;++N){for(var L=z[p][F],k=0;k<d.width;++k){for(var _=0;_<w*d.type;++_)t[L++]=x[D+_*d.width*d.height];D++}F++}break;case m:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(t.buffer)}function Q(e,r){for(var n=new Uint8Array(e),t=0;0!=n[r.value+t];)t+=1;var a=(new TextDecoder).decode(n.slice(r.value,r.value+t));return r.value=r.value+t+1,a}function $(e,r){var n=e.getUint32(0,!0);return r.value=r.value+v,n}function ee(e,r){var n=e.getInt32(r.value,!0);return r.value=r.value+p,n}function re(e,r){var n=e.getUint32(r.value,!0);return r.value=r.value+p,n}function ne(e,r){var n=e[r.value];return r.value=r.value+d,n}function te(e,r){var n=e.getUint8(r.value);return r.value=r.value+d,n}function ae(e,r){var n=Number(e.getBigInt64(r.value,!0));return r.value+=v,n}function ie(e,r){var n=e.getFloat32(r.value,!0);return r.value+=h,n}function oe(e){var r=(31744&e)>>10,n=1023&e;return(e>>15?-1:1)*(r?31===r?n?NaN:1/0:Math.pow(2,r-15)*(1+n/1024):n/1024*6103515625e-14)}function le(e){S.setFloat32(0,e);var r=S.getInt32(0),n=r>>16&32768,t=r>>12&2047,a=r>>23&255;return a<103?n:a>142?(n|=31744,n|=(255==a?0:1)&&8388607&r):a<113?n|=((t|=2048)>>114-a)+(t>>113-a&1):(n|=a-112<<10|t>>1,n+=1&t)}function se(e,r){var n=e.getUint16(r.value,!0);return r.value+=w,n}function fe(e,r,n,t,a){if("string"===t||"stringvector"===t||"iccProfile"===t)return function(e,r,n){var t=(new TextDecoder).decode(new Uint8Array(e).slice(r.value,r.value+n));return r.value=r.value+n,t}(r,n,a);if("chlist"===t)return function(e,r,n,t){for(var a=n.value,i=[];n.value<a+t-1;){var o=Q(r,n),l=ee(e,n),s=te(e,n);n.value+=3;var f=ee(e,n),u=ee(e,n);i.push({name:o,pixelType:l,pLinear:s,xSampling:f,ySampling:u})}return n.value+=1,i}(e,r,n,a);if("chromaticities"===t)return function(e,r){return{redX:ie(e,r),redY:ie(e,r),greenX:ie(e,r),greenY:ie(e,r),blueX:ie(e,r),blueY:ie(e,r),whiteX:ie(e,r),whiteY:ie(e,r)}}(e,n);if("compression"===t)return function(e,r){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][te(e,r)]}(e,n);if("box2i"===t)return function(e,r){return{xMin:re(e,r),yMin:re(e,r),xMax:re(e,r),yMax:re(e,r)}}(e,n);if("lineOrder"===t)return function(e,r){return["INCREASING_Y"][te(e,r)]}(e,n);if("float"===t)return ie(e,n);if("v2f"===t)return function(e,r){return[ie(e,r),ie(e,r)]}(e,n);if("int"===t)return ee(e,n);if("rational"===t)return function(e,r){return[ee(e,r),re(e,r)]}(e,n);if("timecode"===t)return function(e,r){return[re(e,r),re(e,r)]}(e,n);throw"Cannot parse value for unsupported type: "+t}var ue=new DataView(e),ce=new Uint8Array(e),ve={};ue.getUint32(0,!0),ue.getUint8(4,!0),ue.getUint8(5,!0);for(var he={value:8},pe=!0;pe;){var we=Q(e,he);if(0==we)pe=!1;else{var de=fe(ue,e,he,Q(e,he),re(ue,he));ve[we]=de}}var ye,Ee,ge,me,be=ve.dataWindow.yMax+1;switch(ve.compression){case"NO_COMPRESSION":Ee=1,ye=function(e){return new DataView(e.array.buffer,e.offset.value,e.size)};break;case"RLE_COMPRESSION":Ee=1,ye=function(e){var r=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),n=new Uint8Array(V(r)),t=new Uint8Array(n.length);return X(n),Z(n,t),new DataView(t.buffer)};break;case"ZIPS_COMPRESSION":Ee=1,ye=J;break;case"ZIP_COMPRESSION":Ee=16,ye=J;break;case"PIZ_COMPRESSION":Ee=32,ye=function(e){for(var t=e.viewer,a={value:e.offset.value},i=e.width*Ee*(ve.channels.length*e.type),o=new Uint16Array(i),l=new Uint8Array(n),s=0,f=new Array(e.channels),u=0;u<e.channels;u++)f[u]={},f[u].start=s,f[u].end=f[u].start,f[u].nx=e.width,f[u].ny=e.lines,f[u].size=e.type,s+=f[u].nx*f[u].ny*f[u].size;var c=se(t,a),v=se(t,a);if(v>=n)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=v)for(u=0;u<v-c+1;u++)l[u+c]=te(t,a);var h=new Uint16Array(r),p=function(e,n){for(var t=0,a=0;a<r;++a)(0==a||e[a>>3]&1<<(7&a))&&(n[t++]=a);for(var i=t-1;t<r;)n[t++]=0;return i}(l,h),d=re(t,a);for(B(e.array,t,a,d,o,s),u=0;u<e.channels;++u)for(var y=f[u],E=0;E<f[u].size;++E)_(o,y.start+E,y.nx,y.size,y.ny,y.nx*y.size,p);!function(e,r,n){for(var t=0;t<n;++t)r[t]=e[r[t]]}(h,o,s);for(var g=0,m=new Uint8Array(o.buffer.byteLength),b=0;b<e.lines;b++)for(var R=0;R<e.channels;R++){var S=(y=f[R]).nx*y.size,A=new Uint8Array(o.buffer,y.end*w,S*w);m.set(A,g),g+=S*w,y.end+=S}return new DataView(m.buffer)};break;case"DWAA_COMPRESSION":Ee=32,ye=K;break;case"DWAB_COMPRESSION":Ee=256,ye=K;break;default:throw"EXRLoader.parse: "+ve.compression+" is unsupported"}var Re=ve.channels[0].pixelType;if(1===Re)switch(this.type){case THREE.UnsignedByteType:case THREE.FloatType:me=function(e,r){return oe(se(e,r))},ge=w;break;case THREE.HalfFloatType:me=se,ge=w}else{if(2!==Re)throw"EXRLoader.parse: unsupported pixelType "+Re+" for "+ve.compression+".";switch(this.type){case THREE.UnsignedByteType:case THREE.FloatType:me=ie,ge=h;break;case THREE.HalfFloatType:me=function(e,r){return le(ie(e,r))},ge=h}}for(var Se=be/Ee,Ae=0;Ae<Se;Ae++)$(ue,he);var Ue=ve.dataWindow.xMax-ve.dataWindow.xMin+1,Te=ve.dataWindow.yMax-ve.dataWindow.yMin+1,Me=Ue*Te*4;switch(this.type){case THREE.UnsignedByteType:case THREE.FloatType:var Ie=new Float32Array(Me);ve.channels.length<4&&Ie.fill(1,0,Me);break;case THREE.HalfFloatType:Ie=new Uint16Array(Me);ve.channels.length<4&&Ie.fill(15360,0,Me);break;default:console.error("THREE.EXRLoader: unsupported type: ",this.type)}for(var Oe,Ce,xe={R:0,G:1,B:2,A:3},He={size:0,width:Ue,lines:Ee,offset:he,array:ce,viewer:ue,type:Re,channels:ve.channels.length},ze={value:0},Ne=0;Ne<Te/Ee;Ne++){Oe=re(ue,he),Me=re(ue,he),He.lines=Oe+Ee>Te?Te-Oe:Ee,He.offset=he,He.size=Me,Ce=ye(He),he.value+=Me;for(var Pe=0;Pe<Ee;Pe++){var Fe=Pe+Ne*Ee;if(Fe>=Te)break;for(var De=0;De<ve.channels.length;De++)for(var Le=xe[ve.channels[De].name],ke=0;ke<Ue;ke++){var _e=Pe*(ve.channels.length*Ue)+De*Ue+ke;ze.value=_e*ge;var Be=me(Ce,ze);Ie[4*Ue*(Te-1-Fe)+4*ke+Le]=Be}}}if(this.type===THREE.UnsignedByteType){let e,r,n;const t=Ie.length,a=new Uint8Array(t);for(let t=0;t<Te;++t)for(let i=0;i<Ue;++i){r=t*Ue*4+4*i;const o=Ie[n=(Te-1-t)*Ue*4+4*i],l=Ie[n+1],s=Ie[n+2];if((e=s>(e=o>l?o:l)?s:e)<1e-32)a[r]=a[r+1]=a[r+2]=a[r+3]=0;else{const n=A(e);e=256*n[0]/e,a[r]=o*e,a[r+1]=l*e,a[r+2]=s*e,a[r+3]=n[1]+128}}Ie=a}let Xe=this.type===THREE.UnsignedByteType?THREE.RGBEFormat:THREE.RGBAFormat;return{header:ve,width:Ue,height:Te,data:Ie,format:Xe,type:this.type}},setDataType:function(e){return this.type=e,this},load:function(e,r,n,t){return THREE.DataTextureLoader.prototype.load.call(this,e,function(e,n){switch(e.type){case THREE.UnsignedByteType:e.encoding=THREE.RGBEEncoding,e.minFilter=THREE.NearestFilter,e.magFilter=THREE.NearestFilter,e.generateMipmaps=!1,e.flipY=!0;break;case THREE.FloatType:case THREE.HalfFloatType:e.encoding=THREE.LinearEncoding,e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.generateMipmaps=!1,e.flipY=!1}r&&r(e,n)},n,t)}});
//# sourceMappingURL=/sm/727e2dc6f217607749b6c25671673b0e46c3c3384537bc89006abf448a300b56.map